
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Level 2</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'getting_started/onboarding_level2';</script>
    <link rel="icon" href="../_static/aviary_logo.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Level 3" href="onboarding_level3.html" />
    <link rel="prev" title="Level 1" href="onboarding_level1.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/aviary.png" class="logo__image only-light" alt=" - Home"/>
    <script>document.write(`<img src="../_static/aviary.png" class="logo__image only-dark" alt=" - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Aviary Documentation
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="what_aviary_does.html">What Aviary Does</a></li>
<li class="toctree-l1"><a class="reference internal" href="tools_that_aviary_uses.html">Tools That Aviary is Built Upon</a></li>
<li class="toctree-l1"><a class="reference internal" href="expected_user_knowledge.html">Expected User Knowledge</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="onboarding.html">Onboarding Guide</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="onboarding_level1.html">Level 1</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Level 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="onboarding_level3.html">Level 3</a></li>
<li class="toctree-l2"><a class="reference internal" href="onboarding_ext_subsystem.html">Models with External Subsystems</a></li>
<li class="toctree-l2"><a class="reference internal" href="input_csv_phase_info.html">Vehicle Input .csv File and Phase_info Dictionary</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="now_what.html">Now What?</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../user_guide/user_interface.html">Aviary User Interface</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/UI_Levels.html">User Interface Levels</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/examples_of_the_same_mission_at_different_UI_levels.html">Examples of the same mission at different UI levels</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/aviary_commands.html">Command Line Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/input_files.html">Input Files</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../user_guide/drawing_and_running_simple_missions.html">Drawing and running simple missions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_guide/pre_mission_and_mission.html">Pre-Mission and Mission</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_guide/outputs_and_how_to_read_them.html">Outputs and How to Read Them</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_guide/variable_metadata.html">Understanding the Variable Metadata</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../user_guide/features_and_functionalities.html">Features and Functionalities</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/aerodynamics.html">Aerodynamics Subsystem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/external_aero.html">Externally Computed Polars</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/propulsion.html">Propulsion</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/hamilton_standard.html">Hamilton Standard Propulsion Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/mass.html">Mass Subsystem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/subsystems.html">SubsystemBuilderBase</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/using_external_subsystems.html">Using external subsystems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/step_by_step_external_guide.html">Step-by-step guide for creating, testing, and using external subsystems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/battery_subsystem_example.html">In-depth look at the battery subsystem as an example</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/features/overriding.html">Overriding Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/FLOPS_based_detailed_takeoff_and_landing.html">FLOPS Based Detailed Takeoff and Landing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/reserve_missions.html">Reserve Mission</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../user_guide/troubleshooting.html">Troubleshooting</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../examples/intro.html">Discussing the Aviary Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/simple_mission_example.html">Conventional Aircraft and Simple Mission</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/more_advanced_example.html">Optimizing the Mission Profile of a Conventional Aircraft</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/coupled_aircraft_mission_optimization.html">Coupled Aircraft-Mission Optimization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/additional_flight_phases.html">Mission Optimization with Many Phases for a Commercial Aircraft</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/reserve_missions.html">Reserve Mission Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/OAS_subsystem.html">Using Aviary and OpenAeroStruct Together</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/level_2_detailed_takeoff_and_landing.html">Level 2 Detailed Takeoff and Landing</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Theory Guide</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../theory_guide/intro.html">Overview of Aviary Functionality</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../theory_guide/underlying_concepts.html">Underlying Concepts</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../theory_guide/assumptions.html">Assumptions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../theory_guide/aerodynamics.html">Core Aerodynamics Subsystem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../theory_guide/geometry.html">Core Geometry Subsystem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../theory_guide/mass.html">Core Mass Subsystem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../theory_guide/mission.html">Mission Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../theory_guide/propulsion.html">Core Propulsion Subsystem</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../theory_guide/optimization_algorithms.html">Optimization Algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../theory_guide/validation.html">Validation</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Developer Guide</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../developer_guide/codebase_overview.html">Codebase Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer_guide/coding_standards.html">Coding Standards</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer_guide/unit_tests.html">Unit Tests</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer_guide/contributing_guidelines.html">Guidelines for Contributing Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer_guide/how_to_contribute_docs.html">How to Contribute Docs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer_guide/debugging_env_from_github.html">Using Dev Environments from GitHub Actions</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Miscellaneous Resources</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../misc_resources/FAQ.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../misc_resources/glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../misc_resources/resources.html">Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../misc_resources/externally_supported_subsystems.html">Externally Supported Subsystems</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../misc_resources/feature_comparison.html">Feature Comparison with Legacy Codes</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../misc_resources/comparison_to_flops.html">Comparison to FLOPS</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../misc_resources/planned_future_features.html">Planned Future Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_srcdocs/index.html">Source Docs</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/openmdao/Aviary/blob/gh-pages/getting_started/onboarding_level2.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/openmdao/Aviary" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/openmdao/Aviary/issues/new?title=Issue%20on%20page%20%2Fgetting_started/onboarding_level2.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/getting_started/onboarding_level2.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Level 2</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#build-level-2-for-the-same-aircraft-for-bench-gwgm-model">Build level 2 for the same <code class="docutils literal notranslate"><span class="pre">aircraft_for_bench_GwGm</span></code> Model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dissection-of-level-2-for-the-same-aircraft-for-bench-gwgm-model">Dissection of level 2 for the same <code class="docutils literal notranslate"><span class="pre">aircraft_for_bench_GwGm</span></code> model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#level-2-another-example">Level 2: Another example</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">Summary</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="level-2">
<h1>Level 2<a class="headerlink" href="#level-2" title="Link to this heading">#</a></h1>
<p>We have discussed <a class="reference internal" href="onboarding_level1.html"><span class="std std-doc">Level 1</span></a> in great detail. As we have seen, Level 1 is relatively simple.</p>
<p>In Level 2, we see more flexibility and additional choices. You will be exposed to some simple Python code and see how Aviary establishes a problem from beginning to end. Each step is built upon the capabilities of <a class="reference internal" href="onboarding_level3.html"><span class="doc std std-doc">Level 3</span></a>. Users will be led to Level 3 in a natural way.</p>
<p>Level 2 is defined in the <a class="reference external" href="https://github.com/OpenMDAO/Aviary/blob/main/aviary/interface/methods_for_level1.py">aviary/interface/methods_for_level1.py file</a> and it has a single method <code class="docutils literal notranslate"><span class="pre">run_aviary()</span></code> with a few arguments. If you examine <code class="docutils literal notranslate"><span class="pre">interface/level1.py</span></code> you see that Level 1 prepares those arguments and then call <code class="docutils literal notranslate"><span class="pre">run_aviary()</span></code>. For <code class="docutils literal notranslate"><span class="pre">aviary</span> <span class="pre">run_mission</span> <span class="pre">aircraft_for_bench_GwGm</span></code> examples, those arguments are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">aircraft_filename</span></code>: <code class="docutils literal notranslate"><span class="pre">aircraft_for_bench_GwGm</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">phase_info</span></code>: <code class="docutils literal notranslate"><span class="pre">phase_info</span></code> (loaded from <code class="docutils literal notranslate"><span class="pre">aviary/interface/default_phase_info/gasp.py</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">optimizer</span></code>: <code class="docutils literal notranslate"><span class="pre">IPOPT</span></code> (the default is <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">analysis_scheme</span></code>: <code class="docutils literal notranslate"><span class="pre">AnalysisScheme.COLLOCATION</span></code> (the default)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">objective_type</span></code>: <code class="docutils literal notranslate"><span class="pre">None</span></code> (default)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">record_filename</span></code>: <code class="docutils literal notranslate"><span class="pre">aviary_history.db</span></code> (the default)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">restart_filename</span></code>: <code class="docutils literal notranslate"><span class="pre">None</span></code> (the default)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">max_iter</span></code>: 50 (the default)</p></li>
</ul>
<p>All the above arguments are straightforward except <code class="docutils literal notranslate"><span class="pre">objective_type</span></code>. Even though <code class="docutils literal notranslate"><span class="pre">objective_type</span></code> is <code class="docutils literal notranslate"><span class="pre">None</span></code>, it is not treated as <code class="docutils literal notranslate"><span class="pre">None</span></code>. In this scenario, the objective is set based on <code class="docutils literal notranslate"><span class="pre">problem_type</span></code> when using the GASP-based mission method, but not the FLOPS-based mission. There are three options for <code class="docutils literal notranslate"><span class="pre">problem_type</span></code>. Aviary has the following mapping when <code class="docutils literal notranslate"><span class="pre">objective_type</span></code> is not set by user and <code class="docutils literal notranslate"><span class="pre">mission_method</span></code> is <code class="docutils literal notranslate"><span class="pre">GASP</span></code>:</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>problem_type</p></th>
<th class="head"><p>objective</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">SIZING</span></code></p></td>
<td><p>Mission.Objectives.FUEL</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">ALTERNATE</span></code></p></td>
<td><p>Mission.Objectives.FUEL</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">FALLOUT</span></code></p></td>
<td><p>Mission.Objectives.RANGE</p></td>
</tr>
</tbody>
</table>
<p>In Aviary, <code class="docutils literal notranslate"><span class="pre">problem_type</span></code> is set to <code class="docutils literal notranslate"><span class="pre">SIZING</span></code> when it creates a vehicle (see <a class="reference external" href="https://github.com/OpenMDAO/Aviary/blob/main/aviary/utils/UI.py">create_vehicle</a>). As you can see, since <code class="docutils literal notranslate"><span class="pre">problem_type</span></code> is <code class="docutils literal notranslate"><span class="pre">SIZING</span></code> by default in our case and we don’t manually alter this setting, Aviary set objective to <code class="docutils literal notranslate"><span class="pre">Mission.Objectives.FUEL</span></code>. We will discuss more options of <code class="docutils literal notranslate"><span class="pre">objective_type</span></code> later on.</p>
<p>In our onboarding runs, we want to limit the number of iterations to 1 so that they all run faster. As a result, we will not consider whether the optimization converges. So, we will have</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>`max_iter`: 1
</pre></div>
</div>
<p>Level 2 cannot be run via <code class="docutils literal notranslate"><span class="pre">aviary</span></code> command on the command line. Users must develop level 2 Python code. The good news is that the Python code is pretty small. You can follow the following steps in order (we do not include function arguments for simplicity):</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">prob</span> <span class="pre">=</span> <span class="pre">AviaryProblem()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">prob.load_inputs()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">prob.check_and_preprocess_inputs()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">prob.add_pre_mission_systems()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">prob.add_phases()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">prob.add_post_mission_systems()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">prob.link_phases()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">prob.add_driver()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">prob.add_design_variables()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">prob.add_objective()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">prob.setup()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">prob.set_initial_guesses()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">prob.run_aviary_problem()</span></code></p></li>
</ul>
<p>In the rest of this page, we will show a few examples to demonstrate how level 2 runs these steps. We start from rebuilding <code class="docutils literal notranslate"><span class="pre">aircraft_for_bench_GwGm</span></code> model in great details.</p>
<section id="build-level-2-for-the-same-aircraft-for-bench-gwgm-model">
<h2>Build level 2 for the same <code class="docutils literal notranslate"><span class="pre">aircraft_for_bench_GwGm</span></code> Model<a class="headerlink" href="#build-level-2-for-the-same-aircraft-for-bench-gwgm-model" title="Link to this heading">#</a></h2>
<p>We create a level 2 Python script to reproduce the <code class="docutils literal notranslate"><span class="pre">aircraft_for_bench_GwGm</span></code> model run that was used as an example in the level 1 document (this time we won’t use the level 1 functionality). The methods listed above are defined in level 3 (namely, <a class="reference external" href="https://github.com/OpenMDAO/Aviary/blob/main/aviary/interface/methods_for_level2.py">interface/methods_for_level2.py</a>). You can run the code as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">aviary.api</span> <span class="kn">import</span> <span class="n">Aircraft</span><span class="p">,</span> <span class="n">Mission</span>
<span class="kn">import</span> <span class="nn">aviary.api</span> <span class="k">as</span> <span class="nn">av</span>
<span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">deepcopy</span>


<span class="c1"># inputs that run_aviary() requires</span>
<span class="n">aircraft_filename</span> <span class="o">=</span> <span class="s2">&quot;models/test_aircraft/aircraft_for_bench_GwGm.csv&quot;</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="s2">&quot;IPOPT&quot;</span>
<span class="n">analysis_scheme</span> <span class="o">=</span> <span class="n">av</span><span class="o">.</span><span class="n">AnalysisScheme</span><span class="o">.</span><span class="n">COLLOCATION</span>
<span class="n">objective_type</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">record_filename</span> <span class="o">=</span> <span class="s1">&#39;aviary_history.db&#39;</span>
<span class="n">restart_filename</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">max_iter</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">phase_info</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">av</span><span class="o">.</span><span class="n">default_2DOF_phase_info</span><span class="p">)</span>

<span class="c1"># Build problem</span>
<span class="n">prob</span> <span class="o">=</span> <span class="n">av</span><span class="o">.</span><span class="n">AviaryProblem</span><span class="p">(</span><span class="n">analysis_scheme</span><span class="p">)</span>

<span class="c1"># Load aircraft and options data from user</span>
<span class="c1"># Allow for user overrides here</span>
<span class="n">prob</span><span class="o">.</span><span class="n">load_inputs</span><span class="p">(</span><span class="n">aircraft_filename</span><span class="p">,</span> <span class="n">phase_info</span><span class="p">)</span>

<span class="c1"># Preprocess inputs</span>
<span class="n">prob</span><span class="o">.</span><span class="n">check_and_preprocess_inputs</span><span class="p">()</span>

<span class="c1"># adds a pre-mission group (propulsion, geometry, static aerodynamics, and mass)</span>
<span class="n">prob</span><span class="o">.</span><span class="n">add_pre_mission_systems</span><span class="p">()</span>

<span class="c1"># adds a sequence of core mission phases.</span>
<span class="n">prob</span><span class="o">.</span><span class="n">add_phases</span><span class="p">()</span>

<span class="c1"># adds a landing phase</span>
<span class="n">prob</span><span class="o">.</span><span class="n">add_post_mission_systems</span><span class="p">()</span>

<span class="c1"># Link phases and variables</span>
<span class="n">prob</span><span class="o">.</span><span class="n">link_phases</span><span class="p">()</span>

<span class="c1"># adds an optimizer to the driver</span>
<span class="n">prob</span><span class="o">.</span><span class="n">add_driver</span><span class="p">(</span><span class="n">optimizer</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="n">max_iter</span><span class="p">)</span>

<span class="c1"># adds relevant design variables</span>
<span class="n">prob</span><span class="o">.</span><span class="n">add_design_variables</span><span class="p">()</span>

<span class="c1"># Load optimization problem formulation</span>
<span class="c1"># Detail which variables the optimizer can control</span>
<span class="n">prob</span><span class="o">.</span><span class="n">add_objective</span><span class="p">(</span><span class="n">objective_type</span><span class="o">=</span><span class="n">objective_type</span><span class="p">)</span>

<span class="c1"># setup the problem</span>
<span class="n">prob</span><span class="o">.</span><span class="n">setup</span><span class="p">()</span>

<span class="c1"># set initial guesses of states and controls variables</span>
<span class="n">prob</span><span class="o">.</span><span class="n">set_initial_guesses</span><span class="p">()</span>

<span class="c1"># run the problem we just set up</span>
<span class="n">prob</span><span class="o">.</span><span class="n">run_aviary_problem</span><span class="p">(</span><span class="n">record_filename</span><span class="p">,</span> <span class="n">restart_filename</span><span class="o">=</span><span class="n">restart_filename</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/usr/share/miniconda/envs/test/lib/python3.12/site-packages/pyoptsparse/pyOpt_MPI.py:68: UserWarning: mpi4py could not be imported. mpi4py is required to use the parallel gradient analysis and parallel objective analysis for non-gradient based optimizers. Continuing using a dummy MPI module from pyOptSparse.
  warnings.warn(warn)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/usr/share/miniconda/envs/test/lib/python3.12/site-packages/dymos/phase/phase.py:1973: UserWarning: Phase time options have no effect because fix_initial=True or input_initial=True for phase &#39;traj.phases.groundroll&#39;: initial_ref
  warnings.warn(f&#39;Phase time options have no effect because fix_initial=True &#39;
/usr/share/miniconda/envs/test/lib/python3.12/site-packages/dymos/phase/phase.py:1973: UserWarning: Phase time options have no effect because fix_initial=True or input_initial=True for phase &#39;traj.phases.rotation&#39;: initial_ref
  warnings.warn(f&#39;Phase time options have no effect because fix_initial=True &#39;
/usr/share/miniconda/envs/test/lib/python3.12/site-packages/dymos/phase/phase.py:1973: UserWarning: Phase time options have no effect because fix_initial=True or input_initial=True for phase &#39;traj.phases.accel&#39;: initial_ref
  warnings.warn(f&#39;Phase time options have no effect because fix_initial=True &#39;
/usr/share/miniconda/envs/test/lib/python3.12/site-packages/dymos/phase/phase.py:1973: UserWarning: Phase time options have no effect because fix_initial=True or input_initial=True for phase &#39;traj.phases.climb1&#39;: initial_ref
  warnings.warn(f&#39;Phase time options have no effect because fix_initial=True &#39;
/usr/share/miniconda/envs/test/lib/python3.12/site-packages/dymos/phase/phase.py:1973: UserWarning: Phase time options have no effect because fix_initial=True or input_initial=True for phase &#39;traj.phases.climb2&#39;: initial_ref
  warnings.warn(f&#39;Phase time options have no effect because fix_initial=True &#39;
/usr/share/miniconda/envs/test/lib/python3.12/site-packages/dymos/phase/phase.py:1973: UserWarning: Phase time options have no effect because fix_initial=True or input_initial=True for phase &#39;traj.phases.desc1&#39;: initial_ref
  warnings.warn(f&#39;Phase time options have no effect because fix_initial=True &#39;
/usr/share/miniconda/envs/test/lib/python3.12/site-packages/dymos/phase/phase.py:1973: UserWarning: Phase time options have no effect because fix_initial=True or input_initial=True for phase &#39;traj.phases.desc2&#39;: initial_ref
  warnings.warn(f&#39;Phase time options have no effect because fix_initial=True &#39;
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The following variables have been overridden:
  &#39;aircraft:engine:scale_factor
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- Constraint Report [traj] ---
    --- groundroll ---
        None
    --- rotation ---
        [final]   0.0000e+00 == normal_force [lbf]
    --- ascent ---
        [final]   5.0000e+02 == altitude [ft]
        [path]    0.0000e+00 &lt;= load_factor &lt;= 1.1000e+00  [unitless]
        [path]    0.0000e+00 &lt;= fuselage_pitch &lt;= 1.5000e+01  [deg]
    --- accel ---
        [final]   2.5000e+02 == EAS [kn]
    --- climb1 ---
        [final]   1.0000e+04 == altitude [ft]
    --- climb2 ---
        [final]   3.7500e+04 == altitude [ft]
        [final]   1.0000e-01 &lt;= altitude_rate  [ft/min]
        [final]   8.0000e-01 == mach [unitless]
    --- cruise ---
        None
    --- desc1 ---
        [final]   1.0000e+04 == altitude [ft]
    --- desc2 ---
        [final]   1.0000e+03 == altitude [ft]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/usr/share/miniconda/envs/test/lib/python3.12/site-packages/openmdao/recorders/sqlite_recorder.py:226: UserWarning:The existing case recorder file, aviary_history.db, is being overwritten.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Model viewer data has already been recorded for Driver.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Model viewer data has already been recorded for Driver.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Full total jacobian for problem &#39;problem&#39; was computed 3 times, taking 2.1924768380000614 seconds.
Total jacobian shape: (238, 209) 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Jacobian shape: (238, 209)  (6.61% nonzero)
FWD solves: 35   REV solves: 0
Total colors vs. total size: 35 vs 209  (83.25% improvement)

Sparsity computed using tolerance: 1e-25
Time to compute sparsity:   2.1925 sec
Time to compute coloring:   0.1767 sec
Memory to compute coloring:   0.3750 MB
Coloring created on: 2024-04-04 21:37:11
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/usr/share/miniconda/envs/test/lib/python3.12/site-packages/openmdao/core/total_jac.py:1627: DerivativesWarning:Constraints or objectives [(&#39;traj.phases.climb2-&gt;final_boundary_constraint-&gt;mach&#39;, inds=[(11, 0)])] cannot be impacted by the design variables of the problem.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>This is Ipopt version 3.14.14, running with linear solver MUMPS 5.6.2.

Number of nonzeros in equality constraint Jacobian...:     2404
Number of nonzeros in inequality constraint Jacobian.:      410
Number of nonzeros in Lagrangian Hessian.............:        0

Total number of variables............................:      209
                     variables with only lower bounds:        0
                variables with lower and upper bounds:      209
                     variables with only upper bounds:        0
Total number of equality constraints.................:      204
Total number of inequality constraints...............:       33
        inequality constraints with only lower bounds:        1
   inequality constraints with lower and upper bounds:       32
        inequality constraints with only upper bounds:        0

iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
   0  5.0977333e+00 1.74e+03 1.50e+01  -5.0 0.00e+00    -  0.00e+00 0.00e+00   0

Number of Iterations....: 0

                                   (scaled)                 (unscaled)
Objective...............:   5.0977333333333332e+00    5.0977333333333332e+00
Dual infeasibility......:   1.5000000000000000e+01    1.5000000000000000e+01
Constraint violation....:   3.4448886382184898e+00    1.7364599999999916e+03
Variable bound violation:   0.0000000000000000e+00    0.0000000000000000e+00
Complementarity.........:   7.1428571428571420e+15    7.1428571428571420e+15
Overall NLP error.......:   7.1428571428571420e+15    7.1428571428571420e+15


Number of objective function evaluations             = 1
Number of objective gradient evaluations             = 1
Number of equality constraint evaluations            = 1
Number of inequality constraint evaluations          = 1
Number of equality constraint Jacobian evaluations   = 1
Number of inequality constraint Jacobian evaluations = 1
Number of Lagrangian Hessian evaluations             = 0
Total seconds in IPOPT                               = 1.540

EXIT: Maximum Number of Iterations Exceeded.
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<p>In this code, you do the same import as <code class="docutils literal notranslate"><span class="pre">methods_for_level1.py</span></code> does and set the values of all the arguments in <code class="docutils literal notranslate"><span class="pre">run_aviary()</span></code>. Now we will go through each line in detail to explain each step:</p>
</section>
<section id="dissection-of-level-2-for-the-same-aircraft-for-bench-gwgm-model">
<h2>Dissection of level 2 for the same <code class="docutils literal notranslate"><span class="pre">aircraft_for_bench_GwGm</span></code> model<a class="headerlink" href="#dissection-of-level-2-for-the-same-aircraft-for-bench-gwgm-model" title="Link to this heading">#</a></h2>
<p>All the methods of <code class="docutils literal notranslate"><span class="pre">prob</span></code> object (including its creation) are defined in level 3 (<code class="docutils literal notranslate"><span class="pre">methods_for_level2.py</span></code>). We now look at each of them.</p>
<p>We add other inputs that <code class="docutils literal notranslate"><span class="pre">run_aviary()</span></code> requires:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">aircraft_filename</span> <span class="o">=</span> <span class="s2">&quot;models/test_aircraft/aircraft_for_bench_GwGm.csv&quot;</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="s2">&quot;IPOPT&quot;</span>
<span class="n">analysis_scheme</span> <span class="o">=</span> <span class="n">av</span><span class="o">.</span><span class="n">AnalysisScheme</span><span class="o">.</span><span class="n">COLLOCATION</span>
<span class="n">objective_type</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">record_filename</span> <span class="o">=</span> <span class="s1">&#39;aviary_history.db&#39;</span>
<span class="n">restart_filename</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">max_iter</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">prob</span> <span class="o">=</span> <span class="n">av</span><span class="o">.</span><span class="n">AviaryProblem</span><span class="p">(</span><span class="n">analysis_scheme</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Several objects are initialized in this step:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">om</span><span class="o">.</span><span class="n">Group</span><span class="p">()</span>
<span class="bp">self</span><span class="o">.</span><span class="n">pre_mission</span> <span class="o">=</span> <span class="n">PreMissionGroup</span><span class="p">()</span>
<span class="bp">self</span><span class="o">.</span><span class="n">post_mission</span> <span class="o">=</span> <span class="n">PostMissionGroup</span><span class="p">()</span>
<span class="bp">self</span><span class="o">.</span><span class="n">aviary_inputs</span> <span class="o">=</span> <span class="kc">None</span>
<span class="bp">self</span><span class="o">.</span><span class="n">phase_info</span> <span class="o">=</span> <span class="n">phase_info</span>
<span class="bp">self</span><span class="o">.</span><span class="n">traj</span> <span class="o">=</span> <span class="kc">None</span>
<span class="bp">self</span><span class="o">.</span><span class="n">analysis_scheme</span> <span class="o">=</span> <span class="n">analysis_scheme</span>
<span class="bp">self</span><span class="o">.</span><span class="n">pre_mission_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">phase_info</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;pre_mission&#39;</span><span class="p">)</span>
<span class="bp">self</span><span class="o">.</span><span class="n">post_mission_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">phase_info</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;post_mission&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">phase_info</span></code> is a user defined dictionary (in a Python file) that controls the profile of the mission to be simulated (e.g. climb, cruise, descent segments etc).</p>
<p>For <code class="docutils literal notranslate"><span class="pre">analysis_scheme</span></code>, the two options are: <code class="docutils literal notranslate"><span class="pre">AnalysisScheme.COLLOCATION</span></code> (default) and <code class="docutils literal notranslate"><span class="pre">AnalysisScheme.SHOOTING</span></code> which are defined and described in <a class="reference external" href="https://github.com/OpenMDAO/Aviary/blob/main/aviary/variable_info/enums.py">variables_info/enums.py`</a>:</p>
<ul class="simple">
<li><p>COLLOCATION uses the collocation method to optimize all points simultaneously.</p></li>
<li><p>SHOOTING is a forward in time integration method that simulates the trajectory.</p></li>
</ul>
<p>In this onboarding document, only the <code class="docutils literal notranslate"><span class="pre">COLLOCATION</span></code> scheme will be discussed. The line</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">phase_info</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">av</span><span class="o">.</span><span class="n">default_2DOF_phase_info</span><span class="p">)</span>
<span class="n">prob</span><span class="o">.</span><span class="n">load_inputs</span><span class="p">(</span><span class="n">aircraft_filename</span><span class="p">,</span> <span class="n">phase_info</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;aircraft:blended_wing_body_design:num_bays&#39;: (0, &#39;unitless&#39;), &#39;aircraft:crew_and_payload:mass_per_passenger&#39;: (165.0, &#39;lbm&#39;), &#39;aircraft:crew_and_payload:num_business_class&#39;: (0, &#39;unitless&#39;), &#39;aircraft:crew_and_payload:num_first_class&#39;: (0, &#39;unitless&#39;), &#39;aircraft:crew_and_payload:num_passengers&#39;: (180, &#39;unitless&#39;), &#39;aircraft:crew_and_payload:num_tourist_class&#39;: (0, &#39;unitless&#39;), &#39;aircraft:crew_and_payload:passenger_mass_with_bags&#39;: (200, &#39;lbm&#39;), &#39;aircraft:design:compute_htail_volume_coeff&#39;: (False, &#39;unitless&#39;), &#39;aircraft:design:compute_installation_loss&#39;: (True, &#39;unitless&#39;), &#39;aircraft:design:compute_vtail_volume_coeff&#39;: (False, &#39;unitless&#39;), &#39;aircraft:design:part25_structural_category&#39;: (3, &#39;unitless&#39;), &#39;aircraft:design:reserve_fuel_additional&#39;: (4998, &#39;lbm&#39;), &#39;aircraft:design:reserve_fuel_fraction&#39;: (0, &#39;unitless&#39;), &#39;aircraft:design:smooth_mass_discontinuities&#39;: (False, &#39;unitless&#39;), &#39;aircraft:design:ulf_calculated_from_maneuver&#39;: (False, &#39;unitless&#39;), &#39;aircraft:design:use_alt_mass&#39;: (False, &#39;unitless&#39;), &#39;aircraft:electrical:has_hybrid_system&#39;: (False, &#39;unitless&#39;), &#39;aircraft:engine:constant_fuel_consumption&#39;: (array([0.]), &#39;lbm/h&#39;), &#39;aircraft:engine:flight_idle_max_fraction&#39;: (array([1.]), &#39;unitless&#39;), &#39;aircraft:engine:flight_idle_min_fraction&#39;: (array([0.08]), &#39;unitless&#39;), &#39;aircraft:engine:flight_idle_thrust_fraction&#39;: (array([0.]), &#39;unitless&#39;), &#39;aircraft:engine:fuel_flow_scaler_constant_term&#39;: (array([0.]), &#39;unitless&#39;), &#39;aircraft:engine:fuel_flow_scaler_linear_term&#39;: (array([0.]), &#39;unitless&#39;), &#39;aircraft:engine:generate_flight_idle&#39;: ([False], &#39;unitless&#39;), &#39;aircraft:engine:geopotential_alt&#39;: ([False], &#39;unitless&#39;), &#39;aircraft:engine:has_propellers&#39;: ([False], &#39;unitless&#39;), &#39;aircraft:engine:ignore_negative_thrust&#39;: ([False], &#39;unitless&#39;), &#39;aircraft:engine:interpolation_method&#39;: ([&#39;slinear&#39;], &#39;unitless&#39;), &#39;aircraft:engine:num_blades&#39;: (array([0]), &#39;unitless&#39;), &#39;aircraft:engine:num_engines&#39;: (array([2]), &#39;unitless&#39;), &#39;aircraft:engine:num_fuselage_engines&#39;: (array([0]), &#39;unitless&#39;), &#39;aircraft:engine:num_wing_engines&#39;: (array([2]), &#39;unitless&#39;), &#39;aircraft:engine:scale_mass&#39;: ([True], &#39;unitless&#39;), &#39;aircraft:engine:scale_performance&#39;: ([True], &#39;unitless&#39;), &#39;aircraft:engine:subsonic_fuel_flow_scaler&#39;: (array([1.]), &#39;unitless&#39;), &#39;aircraft:engine:supersonic_fuel_flow_scaler&#39;: (array([1.]), &#39;unitless&#39;), &#39;aircraft:engine:type&#39;: ([&lt;GASPEngineType.TURBOJET: 7&gt;], &#39;unitless&#39;), &#39;aircraft:fins:num_fins&#39;: (0, &#39;unitless&#39;), &#39;aircraft:fuel:num_tanks&#39;: (7, &#39;unitless&#39;), &#39;aircraft:fuselage:aisle_width&#39;: (24, &#39;inch&#39;), &#39;aircraft:fuselage:military_cargo_floor&#39;: (False, &#39;unitless&#39;), &#39;aircraft:fuselage:num_aisles&#39;: (1, &#39;unitless&#39;), &#39;aircraft:fuselage:num_fuselages&#39;: (1, &#39;unitless&#39;), &#39;aircraft:fuselage:num_seats_abreast&#39;: (6, &#39;unitless&#39;), &#39;aircraft:fuselage:provide_surface_area&#39;: (True, &#39;unitless&#39;), &#39;aircraft:fuselage:seat_pitch&#39;: (29, &#39;inch&#39;), &#39;aircraft:fuselage:seat_width&#39;: (20.2, &#39;inch&#39;), &#39;aircraft:landing_gear:carrier_based&#39;: (False, &#39;unitless&#39;), &#39;aircraft:landing_gear:drag_coefficient&#39;: (0.0, &#39;unitless&#39;), &#39;aircraft:landing_gear:fixed_gear&#39;: (False, &#39;unitless&#39;), &#39;aircraft:strut:dimensional_location_specified&#39;: (False, &#39;unitless&#39;), &#39;aircraft:vertical_tail:num_tails&#39;: (1, &#39;unitless&#39;), &#39;aircraft:wing:airfoil_technology&#39;: (1.0, &#39;unitless&#39;), &#39;aircraft:wing:choose_fold_location&#39;: (True, &#39;unitless&#39;), &#39;aircraft:wing:detailed_wing&#39;: (False, &#39;unitless&#39;), &#39;aircraft:wing:flap_type&#39;: (&lt;FlapType.DOUBLE_SLOTTED: 4&gt;, &#39;unitless&#39;), &#39;aircraft:wing:fold_dimensional_location_specified&#39;: (False, &#39;unitless&#39;), &#39;aircraft:wing:has_fold&#39;: (False, &#39;unitless&#39;), &#39;aircraft:wing:has_strut&#39;: (False, &#39;unitless&#39;), &#39;aircraft:wing:load_distribution_control&#39;: (2.0, &#39;unitless&#39;), &#39;aircraft:wing:loading_above_20&#39;: (True, &#39;unitless&#39;), &#39;aircraft:wing:num_flap_segments&#39;: (2, &#39;unitless&#39;), &#39;aircraft:wing:num_integration_stations&#39;: (50, &#39;unitless&#39;), &#39;aircraft:wing:span_efficiency_reduction&#39;: (False, &#39;unitless&#39;), &#39;mission:design:cruise_altitude&#39;: (37500, &#39;ft&#39;), &#39;mission:design:rate_of_climb_at_top_of_climb&#39;: (0.0, &#39;ft/min&#39;), &#39;mission:summary:fuel_flow_scaler&#39;: (1, &#39;unitless&#39;), &#39;mission:takeoff:angle_of_attack_runway&#39;: (0.0, &#39;deg&#39;), &#39;mission:takeoff:obstacle_height&#39;: (35.0, &#39;ft&#39;), &#39;mission:takeoff:thrust_incidence&#39;: (0.0, &#39;deg&#39;), &#39;mission:taxi:duration&#39;: (0.1677, &#39;h&#39;), &#39;mission:taxi:mach&#39;: (0.0001, &#39;unitless&#39;), &#39;settings:verbosity&#39;: (&lt;Verbosity.BRIEF: 1&gt;, &#39;unitless&#39;), &#39;verbosity&#39;: (&lt;Verbosity.BRIEF: 1&gt;, &#39;unitless&#39;), &#39;INGASP.JENGSZ&#39;: (4, &#39;unitless&#39;), &#39;test_mode&#39;: (False, &#39;unitless&#39;), &#39;use_surrogates&#39;: (True, &#39;unitless&#39;), &#39;mass_defect&#39;: (10000, &#39;lbm&#39;), &#39;problem_type&#39;: (&lt;ProblemType.SIZING: &#39;sizing&#39;&gt;, &#39;unitless&#39;), &#39;aircraft:controls:cockpit_control_mass_scaler&#39;: (1, &#39;unitless&#39;), &#39;aircraft:controls:control_mass_increment&#39;: (0, &#39;lbm&#39;), &#39;aircraft:controls:stability_augmentation_system_mass&#39;: (0, &#39;lbm&#39;), &#39;aircraft:controls:stability_augmentation_system_mass_scaler&#39;: (1, &#39;unitless&#39;), &#39;aircraft:crew_and_payload:cargo_mass&#39;: (10040, &#39;lbm&#39;), &#39;aircraft:design:cg_delta&#39;: (0.25, &#39;unitless&#39;), &#39;aircraft:design:cockpit_control_mass_coefficient&#39;: (16.5, &#39;unitless&#39;), &#39;aircraft:design:drag_increment&#39;: (0.00175, &#39;unitless&#39;), &#39;aircraft:design:equipment_mass_coefficients&#39;: ([928, 0.0736, 0.112, 0.14, 1959, 1.65, 551, 11192, 5, 3, 50, 7.6, 12], &#39;unitless&#39;), &#39;aircraft:design:max_structural_speed&#39;: (402.5, &#39;mi/h&#39;), &#39;aircraft:design:static_margin&#39;: (0.03, &#39;unitless&#39;), &#39;aircraft:design:structural_mass_increment&#39;: (0, &#39;lbm&#39;), &#39;aircraft:design:supercritical_drag_shift&#39;: (0.033, &#39;unitless&#39;), &#39;aircraft:engine:additional_mass_fraction&#39;: (array([0.135]), &#39;unitless&#39;), &#39;aircraft:engine:data_file&#39;: ([&#39;models/engines/turbofan_23k_1.deck&#39;], &#39;unitless&#39;), &#39;aircraft:engine:mass_scaler&#39;: (array([1]), &#39;unitless&#39;), &#39;aircraft:engine:mass_specific&#39;: (array([0.21366]), &#39;lbm/lbf&#39;), &#39;aircraft:engine:pod_mass_scaler&#39;: (array([1]), &#39;unitless&#39;), &#39;aircraft:engine:pylon_factor&#39;: (array([1.25]), &#39;unitless&#39;), &#39;aircraft:engine:reference_diameter&#39;: (array([5.8]), &#39;ft&#39;), &#39;aircraft:engine:reference_sls_thrust&#39;: (array([28690]), &#39;lbf&#39;), &#39;aircraft:engine:scale_factor&#39;: (array([1]), &#39;unitless&#39;), &#39;aircraft:engine:scaled_sls_thrust&#39;: (array([28690]), &#39;lbf&#39;), &#39;aircraft:engine:wing_locations&#39;: (array([0.35]), &#39;unitless&#39;), &#39;aircraft:fuel:density&#39;: (6.687, &#39;lbm/galUS&#39;), &#39;aircraft:fuel:fuel_margin&#39;: (0, &#39;unitless&#39;), &#39;aircraft:fuel:fuel_system_mass_coefficient&#39;: (0.041, &#39;unitless&#39;), &#39;aircraft:fuel:fuel_system_mass_scaler&#39;: (1, &#39;unitless&#39;), &#39;aircraft:fuel:wing_fuel_fraction&#39;: (0.6, &#39;unitless&#39;), &#39;aircraft:fuselage:delta_diameter&#39;: (4.5, &#39;ft&#39;), &#39;aircraft:fuselage:flat_plate_area_increment&#39;: (0.25, &#39;ft**2&#39;), &#39;aircraft:fuselage:form_factor&#39;: (1.25, &#39;unitless&#39;), &#39;aircraft:fuselage:mass_coefficient&#39;: (128, &#39;unitless&#39;), &#39;aircraft:fuselage:nose_fineness&#39;: (1, &#39;unitless&#39;), &#39;aircraft:fuselage:pilot_compartment_length&#39;: (9.5, &#39;ft&#39;), &#39;aircraft:fuselage:pressure_differential&#39;: (7.5, &#39;psi&#39;), &#39;aircraft:fuselage:tail_fineness&#39;: (3, &#39;unitless&#39;), &#39;aircraft:fuselage:wetted_area_factor&#39;: (4000, &#39;unitless&#39;), &#39;aircraft:horizontal_tail:area&#39;: (0, &#39;ft**2&#39;), &#39;aircraft:horizontal_tail:aspect_ratio&#39;: (4.75, &#39;unitless&#39;), &#39;aircraft:horizontal_tail:form_factor&#39;: (1.25, &#39;unitless&#39;), &#39;aircraft:horizontal_tail:mass_coefficient&#39;: (0.232, &#39;unitless&#39;), &#39;aircraft:horizontal_tail:moment_ratio&#39;: (0.2307, &#39;unitless&#39;), &#39;aircraft:horizontal_tail:sweep&#39;: (25, &#39;deg&#39;), &#39;aircraft:horizontal_tail:taper_ratio&#39;: (0.352, &#39;unitless&#39;), &#39;aircraft:horizontal_tail:thickness_to_chord&#39;: (0.12, &#39;unitless&#39;), &#39;aircraft:horizontal_tail:vertical_tail_fraction&#39;: (0, &#39;unitless&#39;), &#39;aircraft:horizontal_tail:volume_coefficient&#39;: (1.189, &#39;unitless&#39;), &#39;aircraft:landing_gear:main_gear_location&#39;: (0.15, &#39;unitless&#39;), &#39;aircraft:landing_gear:main_gear_mass_coefficient&#39;: (0.85, &#39;unitless&#39;), &#39;aircraft:landing_gear:mass_coefficient&#39;: (0.04, &#39;unitless&#39;), &#39;aircraft:landing_gear:tail_hook_mass_scaler&#39;: (1, &#39;unitless&#39;), &#39;aircraft:landing_gear:total_mass_scaler&#39;: (1, &#39;unitless&#39;), &#39;aircraft:nacelle:clearance_ratio&#39;: (array([0.2]), &#39;unitless&#39;), &#39;aircraft:nacelle:core_diameter_ratio&#39;: (array([1.25]), &#39;unitless&#39;), &#39;aircraft:nacelle:fineness&#39;: (array([2]), &#39;unitless&#39;), &#39;aircraft:nacelle:form_factor&#39;: (array([1.5]), &#39;unitless&#39;), &#39;aircraft:nacelle:mass_specific&#39;: (array([3]), &#39;lbm/ft**2&#39;), &#39;aircraft:strut:area_ratio&#39;: (0, &#39;unitless&#39;), &#39;aircraft:strut:attachment_location&#39;: (0, &#39;ft&#39;), &#39;aircraft:strut:attachment_location_dimensionless&#39;: (0, &#39;unitless&#39;), &#39;aircraft:strut:fuselage_interference_factor&#39;: (0, &#39;unitless&#39;), &#39;aircraft:strut:mass_coefficient&#39;: (0, &#39;unitless&#39;), &#39;aircraft:strut:thickness_to_chord&#39;: (0, &#39;unitless&#39;), &#39;aircraft:vertical_tail:area&#39;: (0, &#39;ft**2&#39;), &#39;aircraft:vertical_tail:aspect_ratio&#39;: (1.67, &#39;unitless&#39;), &#39;aircraft:vertical_tail:form_factor&#39;: (1.25, &#39;unitless&#39;), &#39;aircraft:vertical_tail:mass_coefficient&#39;: (0.289, &#39;unitless&#39;), &#39;aircraft:vertical_tail:moment_ratio&#39;: (2.362, &#39;unitless&#39;), &#39;aircraft:vertical_tail:sweep&#39;: (35, &#39;deg&#39;), &#39;aircraft:vertical_tail:taper_ratio&#39;: (0.801, &#39;unitless&#39;), &#39;aircraft:vertical_tail:thickness_to_chord&#39;: (0.12, &#39;unitless&#39;), &#39;aircraft:vertical_tail:volume_coefficient&#39;: (0.145, &#39;unitless&#39;), &#39;aircraft:wing:aspect_ratio&#39;: (10.13, &#39;unitless&#39;), &#39;aircraft:wing:center_distance&#39;: (0.463, &#39;unitless&#39;), &#39;aircraft:wing:flap_chord_ratio&#39;: (0.3, &#39;unitless&#39;), &#39;aircraft:wing:flap_deflection_landing&#39;: (40, &#39;deg&#39;), &#39;aircraft:wing:flap_deflection_takeoff&#39;: (10, &#39;deg&#39;), &#39;aircraft:wing:flap_drag_increment_optimum&#39;: (0.1, &#39;unitless&#39;), &#39;aircraft:wing:flap_lift_increment_optimum&#39;: (1.5, &#39;unitless&#39;), &#39;aircraft:wing:flap_span_ratio&#39;: (0.65, &#39;unitless&#39;), &#39;aircraft:wing:fold_mass_coefficient&#39;: (0, &#39;unitless&#39;), &#39;aircraft:wing:folded_span&#39;: (0, &#39;ft&#39;), &#39;aircraft:wing:form_factor&#39;: (1.25, &#39;unitless&#39;), &#39;aircraft:wing:fuselage_interference_factor&#39;: (1.1, &#39;unitless&#39;), &#39;aircraft:wing:height&#39;: (8, &#39;ft&#39;), &#39;aircraft:wing:high_lift_mass_coefficient&#39;: (1.9, &#39;unitless&#39;), &#39;aircraft:wing:incidence&#39;: (1.5, &#39;deg&#39;), &#39;aircraft:wing:loading&#39;: (128, &#39;lbf/ft**2&#39;), &#39;aircraft:wing:mass_coefficient&#39;: (102.5, &#39;unitless&#39;), &#39;aircraft:wing:max_lift_ref&#39;: (1.15, &#39;unitless&#39;), &#39;aircraft:wing:max_slat_deflection_landing&#39;: (10, &#39;deg&#39;), &#39;aircraft:wing:max_slat_deflection_takeoff&#39;: (10, &#39;deg&#39;), &#39;aircraft:wing:max_thickness_location&#39;: (0.4, &#39;unitless&#39;), &#39;aircraft:wing:min_pressure_location&#39;: (0.3, &#39;unitless&#39;), &#39;aircraft:wing:mounting_type&#39;: (0, &#39;unitless&#39;), &#39;aircraft:wing:optimum_flap_deflection&#39;: (55, &#39;deg&#39;), &#39;aircraft:wing:optimum_slat_deflection&#39;: (20, &#39;deg&#39;), &#39;aircraft:wing:slat_chord_ratio&#39;: (0.15, &#39;unitless&#39;), &#39;aircraft:wing:slat_lift_increment_optimum&#39;: (0.93, &#39;unitless&#39;), &#39;aircraft:wing:surface_ctrl_mass_coefficient&#39;: (0.95, &#39;unitless&#39;), &#39;aircraft:wing:sweep&#39;: (25, &#39;deg&#39;), &#39;aircraft:wing:taper_ratio&#39;: (0.33, &#39;unitless&#39;), &#39;aircraft:wing:thickness_to_chord_root&#39;: (0.15, &#39;unitless&#39;), &#39;aircraft:wing:thickness_to_chord_tip&#39;: (0.12, &#39;unitless&#39;), &#39;aircraft:wing:zero_lift_angle&#39;: (-1.2, &#39;deg&#39;), &#39;mission:design:gross_mass&#39;: (175400, &#39;lbm&#39;), &#39;mission:design:mach&#39;: (0.8, &#39;unitless&#39;), &#39;mission:design:range&#39;: (3675, &#39;NM&#39;), &#39;mission:landing:braking_delay&#39;: (1, &#39;s&#39;), &#39;mission:landing:glide_to_stall_ratio&#39;: (1.3, &#39;unitless&#39;), &#39;mission:landing:maximum_flare_load_factor&#39;: (1.15, &#39;unitless&#39;), &#39;mission:landing:maximum_sink_rate&#39;: (900, &#39;ft/min&#39;), &#39;mission:landing:obstacle_height&#39;: (50, &#39;ft&#39;), &#39;mission:landing:touchdown_sink_rate&#39;: (5, &#39;ft/s&#39;), &#39;mission:takeoff:decision_speed_increment&#39;: (10, &#39;kn&#39;), &#39;mission:takeoff:rotation_speed_increment&#39;: (5, &#39;kn&#39;), &#39;settings:equations_of_motion&#39;: (&lt;EquationsOfMotion.TWO_DEGREES_OF_FREEDOM: &#39;2DOF&#39;&gt;, &#39;unitless&#39;), &#39;settings:mass_method&#39;: (&lt;LegacyCode.GASP: &#39;GASP&#39;&gt;, &#39;unitless&#39;), &#39;mission:summary:cruise_mass_final&#39;: (140320.0, &#39;lbm&#39;), &#39;mission:summary:gross_mass&#39;: (175400, &#39;lbm&#39;), &#39;engine_models&#39;: ([&lt;aviary.subsystems.propulsion.engine_deck.EngineDeck object at 0x7fb03a7f4ed0&gt;], &#39;unitless&#39;), &#39;aircraft:propulsion:total_num_engines&#39;: (2, &#39;unitless&#39;), &#39;aircraft:propulsion:total_num_fuselage_engines&#39;: (0, &#39;unitless&#39;), &#39;aircraft:propulsion:total_num_wing_engines&#39;: (2, &#39;unitless&#39;)}
</pre></div>
</div>
</div>
</div>
<p>is a function that has a few tasks:</p>
<ul class="simple">
<li><p>Read aircraft deck file <code class="docutils literal notranslate"><span class="pre">aircraft_filename</span></code></p></li>
<li><p>Read phase info file <code class="docutils literal notranslate"><span class="pre">phase_info</span></code></p></li>
<li><p>Build core subsystems</p></li>
</ul>
<p>We have seen <code class="docutils literal notranslate"><span class="pre">aircraft_filename</span></code> file (a <code class="docutils literal notranslate"><span class="pre">.csv</span></code> file) in our level 1 examples. In <a class="reference internal" href="onboarding_level1.html"><span class="doc std std-doc">level 1</span></a>, we simply called it input file. An aircraft model can also be directly defined in Python, by setting up an <code class="docutils literal notranslate"><span class="pre">AviaryValues</span></code> object with the desired inputs and options normally found in an input file. That object can be provided in the place of <code class="docutils literal notranslate"><span class="pre">aircraft_filename</span></code>.</p>
<p>Engines are built by using <code class="docutils literal notranslate"><span class="pre">aircraft:engine:data_file</span></code> in the .csv file. For example in <code class="docutils literal notranslate"><span class="pre">aircraft_for_bench_GwGm.csv</span></code> file, we see:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">aircraft</span><span class="p">:</span><span class="n">engine</span><span class="p">:</span><span class="n">data_file</span><span class="p">,</span><span class="n">models</span><span class="o">/</span><span class="n">engines</span><span class="o">/</span><span class="n">turbofan_28k</span><span class="o">.</span><span class="n">deck</span><span class="p">,</span><span class="n">unitless</span>
</pre></div>
</div>
<p>So, <code class="docutils literal notranslate"><span class="pre">aircraft:engine:data_file</span></code> has value <code class="docutils literal notranslate"><span class="pre">models/engines/turbofan_28k.deck,unitless</span></code>. The top rows of engine deck file are:</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p><strong>Mach_Number (unitless)</strong></p></th>
<th class="head"><p><strong>Altitude (ft)</strong></p></th>
<th class="head"><p><strong>Throttle (unitless)</strong></p></th>
<th class="head"><p><strong>Gross_Thrust (lbf)</strong></p></th>
<th class="head"><p><strong>Ram_Drag (lbf)</strong></p></th>
<th class="head"><p><strong>Fuel_Flow (lb/h)</strong></p></th>
<th class="head"><p><strong>NOx_Rate (lb/h)</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0.0,</p></td>
<td><p>0.0,</p></td>
<td><p>50.0,</p></td>
<td><p>28928.1,</p></td>
<td><p>0.0,</p></td>
<td><p>8662.3,</p></td>
<td><p>61.9894</p></td>
</tr>
<tr class="row-odd"><td><p>0.0,</p></td>
<td><p>0.0,</p></td>
<td><p>48.0,</p></td>
<td><p>26999.7,</p></td>
<td><p>0.0,</p></td>
<td><p>7932.6,</p></td>
<td><p>49.2185</p></td>
</tr>
<tr class="row-even"><td><p>0.0,</p></td>
<td><p>0.0,</p></td>
<td><p>46.0,</p></td>
<td><p>25071.1,</p></td>
<td><p>0.0,</p></td>
<td><p>7258.1,</p></td>
<td><p>33.3976</p></td>
</tr>
<tr class="row-odd"><td><p>0.0,</p></td>
<td><p>0.0,</p></td>
<td><p>42.0,</p></td>
<td><p>21214.0,</p></td>
<td><p>0.0,</p></td>
<td><p>5979.1,</p></td>
<td><p>19.8547</p></td>
</tr>
<tr class="row-even"><td><p>0.0,</p></td>
<td><p>0.0,</p></td>
<td><p>38.0,</p></td>
<td><p>17356.9,</p></td>
<td><p>0.0,</p></td>
<td><p>4795.2,</p></td>
<td><p>17.5877</p></td>
</tr>
</tbody>
</table>
<p>Users can provide an <code class="docutils literal notranslate"><span class="pre">EngineModel</span></code> instance of their own to use in Aviary’s propulsion systems by adding it to <code class="docutils literal notranslate"><span class="pre">engine_models</span></code>.</p>
<p>Other subsystems, including mass, geometry, and aerodynamics, are set up according to which legacy code options the user has specified in their input file, using <code class="docutils literal notranslate"><span class="pre">settings:equations_of_motion</span></code> and <code class="docutils literal notranslate"><span class="pre">settings:mass_method</span></code>. Aerodynamics is set up to match the selected equations of motion, while geometry will use either GASP, FLOPS, or both methods as required to calculate all values needed by other subsystems.</p>
<p>Next we check the user-provided inputs:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prob</span><span class="o">.</span><span class="n">check_and_preprocess_inputs</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>This method checks the user-supplied input values for any potential problems. These problems include variable names that are not recognized in Aviary, conflicting options or values, or units mismatching.</p>
<p>Next, we add pre-mission systems:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prob</span><span class="o">.</span><span class="n">add_pre_mission_systems</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>This call adds a pre-mission group (also called static analysis group) which includes pre-mission propulsion, geometry, pre-mission aerodynamics, and mass subsystems.</p>
<p>For <code class="docutils literal notranslate"><span class="pre">height_energy</span></code> missions, aviary currently models FLOPS’ “simplified” takeoff as defined in <a class="reference external" href="https://github.com/OpenMDAO/Aviary/blob/main/aviary/mission/flops_based/phases/simplified_takeoff.py">mission/flops_based/phases/simplified_takeoff.py</a>.</p>
<p>Next is the line</p>
<div class="cell tag_hide-output docutils container">
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prob</span><span class="o">.</span><span class="n">add_phases</span><span class="p">()</span>
</pre></div>
</div>
</div>
<details class="hide below-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell output</span>
<span class="expanded">Hide code cell output</span>
</summary>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;dymos.trajectory.trajectory.Trajectory at 0x7fb02d9baf90&gt;
</pre></div>
</div>
</div>
</details>
</div>
<p>which adds a sequence of core mission phases. In addition, if <code class="docutils literal notranslate"><span class="pre">mission_method</span></code> is <code class="docutils literal notranslate"><span class="pre">2dof</span></code> and <code class="docutils literal notranslate"><span class="pre">ascent</span></code> is a phase, it adds an equality constraint to the problem to ensure that the TAS at the end of the groundroll phase is equal to the rotation velocity at the start of the rotation phase (<code class="docutils literal notranslate"><span class="pre">_add_groundroll_eq_constraint(phase)</span></code>). If <code class="docutils literal notranslate"><span class="pre">mission_method</span></code> is <code class="docutils literal notranslate"><span class="pre">height_energy</span></code>, it sets up trajectory parameters by calling <code class="docutils literal notranslate"><span class="pre">setup_trajectory_params()</span></code>. If <code class="docutils literal notranslate"><span class="pre">mission_method</span></code> is <code class="docutils literal notranslate"><span class="pre">solved</span></code>, it has a block of code to make sure that the trajectory is smooth by applying boundary constraints between phases (e.g. fuselage pitch angle or true airspeed).</p>
<p>It follows by adding post-mission subsystems:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prob</span><span class="o">.</span><span class="n">add_post_mission_systems</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Similar to pre-mission, it adds a landing phase if <code class="docutils literal notranslate"><span class="pre">include_landing</span></code> key of <code class="docutils literal notranslate"><span class="pre">post_mission</span></code> has value of <code class="docutils literal notranslate"><span class="pre">True</span></code>. If user chooses to define a <code class="docutils literal notranslate"><span class="pre">post_mission</span></code>, it will override the default. For <code class="docutils literal notranslate"><span class="pre">2dof</span></code> missions, landing is defined in <a class="reference external" href="https://github.com/OpenMDAO/Aviary/blob/main/aviary/mission/gasp_based/phases/landing_group.py">mission/gasp_based/phases/landing_group.py</a>. For <code class="docutils literal notranslate"><span class="pre">simple</span></code> mission, landing means a <a class="reference external" href="https://github.com/OpenMDAO/Aviary/blob/main/aviary/mission/flops_based/phases/simplified_landing.py">simplified landing</a>. Note that the <code class="docutils literal notranslate"><span class="pre">solved</span></code> method currently doesn’t have any post mission systems.</p>
<p>The next line is</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prob</span><span class="o">.</span><span class="n">link_phases</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>This is important for allowing each phase of flight to pass to the next without discontinuities in the parameters. Consider Dymos’ <a class="reference external" href="https://openmdao.github.io/dymos/examples/balanced_field/balanced_field.html">Aircraft Balanced Field Length Calculation</a> example. In that example, we see separate nonlinear boundary constraints, nonlinear path constraints, and phase continuity constraints between phases. We don’t want to go deeper in this function call, but just point out that each individual link can be set via dymos function <code class="docutils literal notranslate"><span class="pre">link_phases</span></code>. See <a class="reference external" href="https://openmdao.github.io/dymos/api/trajectory_api.html">dymos API</a> for more details.</p>
<p>The code blocks in this function (namely, <code class="docutils literal notranslate"><span class="pre">link_phases()</span></code>) are for <code class="docutils literal notranslate"><span class="pre">2DOF</span></code>, <code class="docutils literal notranslate"><span class="pre">simple</span></code>, and <code class="docutils literal notranslate"><span class="pre">solved</span></code> missions. The links are set up based on physical principals (e.g. you can’t have instantaneous changes in mass, velocity, position etc.). Special care is required if the user selects a different or unusual set of phases.</p>
<p>Now, our aircraft and the mission are fully defined. We are ready to define an optimization problem. This is achieved by adding an optimization driver, adding design variables, and an objective.</p>
<p>For <code class="docutils literal notranslate"><span class="pre">add_driver</span></code> function, we accept <code class="docutils literal notranslate"><span class="pre">use_coloring=None</span></code>. Coloring is a technique that OpenMDAO uses to compute partial derivatives efficiently. This will become important later.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prob</span><span class="o">.</span><span class="n">add_driver</span><span class="p">(</span><span class="n">optimizer</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="n">max_iter</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Drivers available for use in Aviary are <code class="docutils literal notranslate"><span class="pre">SLSQP</span></code>, <code class="docutils literal notranslate"><span class="pre">SNOPT</span></code>, and <code class="docutils literal notranslate"><span class="pre">IPOPT</span></code>. The table below summarizes the basic setting along with sample values (the settings are options required by each optimizer):</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p><strong>Optimizers</strong></p></th>
<th class="head"><p><strong>Drivers</strong></p></th>
<th class="head"><p><strong>Settings</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">SNOPT</span></code></p></td>
<td><p>om.pyOptSparseDriver()</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Major</span> <span class="pre">iterations</span> <span class="pre">limit</span></code>: 50<BR/><code class="docutils literal notranslate"><span class="pre">Major</span> <span class="pre">optimality</span> <span class="pre">tolerance</span></code>: 1e-4<BR/><code class="docutils literal notranslate"><span class="pre">Major</span> <span class="pre">feasibility</span> <span class="pre">tolerance</span></code>: 1e-6<BR/><code class="docutils literal notranslate"><span class="pre">iSumm</span></code>: 6</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">IPOPT</span></code></p></td>
<td><p>om.pyOptSparseDriver()</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">tol</span></code>: 1e-9<BR/><code class="docutils literal notranslate"><span class="pre">mu_init</span></code>: 1e-5<BR/><code class="docutils literal notranslate"><span class="pre">max_iter</span></code>: 50<BR/><code class="docutils literal notranslate"><span class="pre">print_level</span></code>: 5</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">SLSQP</span></code></p></td>
<td><p>om.ScipyOptimizeDriver()</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">tol</span></code>: 1.0E-9<BR/><code class="docutils literal notranslate"><span class="pre">maxiter</span></code>: 50<BR/><code class="docutils literal notranslate"><span class="pre">disp</span></code>: True</p></td>
</tr>
</tbody>
</table>
<p>Note that <code class="docutils literal notranslate"><span class="pre">SLSQP</span></code> is freely available, but its performance is not as good as <code class="docutils literal notranslate"><span class="pre">SNOPT</span></code> and <code class="docutils literal notranslate"><span class="pre">IPOPT</span></code> sometimes. <code class="docutils literal notranslate"><span class="pre">SNOPT</span></code> is a commercial optimizer, but it is free for academic use. <code class="docutils literal notranslate"><span class="pre">IPOPT</span></code> is an open-source optimizer and it is free for all users.</p>
<p>Design variables (and constraints) are set in the line <code class="docutils literal notranslate"><span class="pre">prob.add_design_variables()</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prob</span><span class="o">.</span><span class="n">add_design_variables</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>For default <code class="docutils literal notranslate"><span class="pre">FLOPS</span></code> mission model, it is relatively simple:</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p><strong>Design Variables</strong></p></th>
<th class="head"><p><strong>Lower Bound</strong></p></th>
<th class="head"><p><strong>Upper Bound</strong></p></th>
<th class="head"><p><strong>Reference Value</strong></p></th>
<th class="head"><p><strong>Units</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Mission.Design.GROSS_MASS</p></td>
<td><p>100.e3</p></td>
<td><p>200.e3</p></td>
<td><p>135.e3</p></td>
<td><p>lbm</p></td>
</tr>
</tbody>
</table>
<p>For default <code class="docutils literal notranslate"><span class="pre">GASP</span></code> mission model, the design variables and constraints depend on the type of problems (<code class="docutils literal notranslate"><span class="pre">SIZING</span></code>, <code class="docutils literal notranslate"><span class="pre">ALTERNATE</span></code>, or <code class="docutils literal notranslate"><span class="pre">FALLOUT</span></code>, see <code class="docutils literal notranslate"><span class="pre">ProblemType</span></code> class in <code class="docutils literal notranslate"><span class="pre">aviary/variable_info/enums.py</span></code> for details). First, there are four common design variables and two common constraints. There are two more design variables and two constraints for sizing problem.</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p><strong>Problem Type</strong></p></th>
<th class="head"><p><strong>Design Variables</strong></p></th>
<th class="head"><p><strong>Lower Bound</strong></p></th>
<th class="head"><p><strong>Upper Bound</strong></p></th>
<th class="head"><p><strong>Reference</strong> Value</p></th>
<th class="head"><p>Units</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Any</p></td>
<td><p>Mission.Takeoff.ASCENT_T_INITIAL</p></td>
<td><p>0</p></td>
<td><p>100</p></td>
<td><p>30.0</p></td>
<td><p>s</p></td>
</tr>
<tr class="row-odd"><td><p>Any</p></td>
<td><p>Mission.Takeoff.ASCENT_DURATION</p></td>
<td><p>1</p></td>
<td><p>1000</p></td>
<td><p>10.0</p></td>
<td><p>s</p></td>
</tr>
<tr class="row-even"><td><p>Any</p></td>
<td><p>tau_gear</p></td>
<td><p>0.01</p></td>
<td><p>1.0</p></td>
<td><p>1</p></td>
<td><p>s</p></td>
</tr>
<tr class="row-odd"><td><p>Any</p></td>
<td><p>tau_flaps</p></td>
<td><p>0.01</p></td>
<td><p>1.0</p></td>
<td><p>1</p></td>
<td><p>s</p></td>
</tr>
<tr class="row-even"><td><p>SIZING</p></td>
<td><p>Mission.Design.GROSS_MASS</p></td>
<td><p>10.</p></td>
<td><p>400.e3</p></td>
<td><p>175_000</p></td>
<td><p>lbm</p></td>
</tr>
<tr class="row-odd"><td><p>SIZING</p></td>
<td><p>Mission.Summary.GROSS_MASS</p></td>
<td><p>10.</p></td>
<td><p>400.e3</p></td>
<td><p>175_000</p></td>
<td><p>lbm</p></td>
</tr>
<tr class="row-even"><td><p>ALTERNATE</p></td>
<td><p>Mission.Summary.GROSS_MASS</p></td>
<td><p>0</p></td>
<td><p>infinite</p></td>
<td><p>175_000</p></td>
<td><p>lbm</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Problem Type</strong></p></td>
<td><p><strong>Constraint</strong></p></td>
<td><p><strong>Relation</strong></p></td>
<td><p><strong>Value</strong></p></td>
<td><p><strong>Reference Value</strong></p></td>
<td><p><strong>Units</strong></p></td>
</tr>
<tr class="row-even"><td><p>Any</p></td>
<td><p>h_fit.h_init_gear</p></td>
<td><p>=</p></td>
<td><p>50.0</p></td>
<td><p>50.0</p></td>
<td><p>ft</p></td>
</tr>
<tr class="row-odd"><td><p>Any</p></td>
<td><p>h_fit.h_init_flaps</p></td>
<td><p>=</p></td>
<td><p>400.0</p></td>
<td><p>400.0</p></td>
<td><p>ft</p></td>
</tr>
<tr class="row-even"><td><p>SIZING</p></td>
<td><p>Mission.Constraints.RANGE_RESIDUAL</p></td>
<td><p>=</p></td>
<td><p>0</p></td>
<td><p>10</p></td>
<td><p>unitless</p></td>
</tr>
<tr class="row-odd"><td><p>ALTERNATE</p></td>
<td><p>Mission.Constraints.RANGE_RESIDUAL</p></td>
<td><p>=</p></td>
<td><p>0</p></td>
<td><p>10</p></td>
<td><p>lbm</p></td>
</tr>
</tbody>
</table>
<p>In the above table, there are two hard-coded design variables: <code class="docutils literal notranslate"><span class="pre">tau_gear</span></code> and <code class="docutils literal notranslate"><span class="pre">tau_flaps</span></code>. They represent fractions of ascent time to start gear retraction and flaps retraction. There are two hard-coded constraints: <code class="docutils literal notranslate"><span class="pre">h_fit.h_init_gear</span></code> and <code class="docutils literal notranslate"><span class="pre">h_fit.h_init_flaps</span></code>. They are the altitudes of initial gear retraction and initial flaps retraction. The underscore in number “175_000” is for readability only.</p>
<p>There are other constraints using OpenMDAO’s <code class="docutils literal notranslate"><span class="pre">EQConstraintComp</span></code> component. We will not go into the details as this part is complicated and needs special attention. Note that each subsystem (for example engine model) might have their own design variables (think, for example, sizing the engine). Aviary goes through all subsystems and adds appropriate design variables.</p>
<p>You can override all the functions in level 3. So, you can set up your constraints in level 3 if the above ones do not meet your requirements.</p>
<p>The optimization objective is added to the problem by this line:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prob</span><span class="o">.</span><span class="n">add_objective</span><span class="p">(</span><span class="n">objective_type</span><span class="o">=</span><span class="n">objective_type</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The selection of objective is a little complicated.</p>
<p>Earlier in this page, we have discussed the objective when <code class="docutils literal notranslate"><span class="pre">objective_type=None</span></code> and <code class="docutils literal notranslate"><span class="pre">mission_method</span></code> is <code class="docutils literal notranslate"><span class="pre">2DOF</span></code>. Let us discuss the other situations.</p>
<p>There are several objective types that users can choose: <code class="docutils literal notranslate"><span class="pre">mass</span></code>, <code class="docutils literal notranslate"><span class="pre">hybrid_objective</span></code>, <code class="docutils literal notranslate"><span class="pre">fuel_burned</span></code>, and <code class="docutils literal notranslate"><span class="pre">fuel</span></code>.</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>objective_type</p></th>
<th class="head"><p>objective</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>mass</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Dynamic.Mission.MASS</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>hybrid_objective</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-final_mass</span> <span class="pre">/</span> <span class="pre">{takeoff_mass}</span> <span class="pre">+</span> <span class="pre">final_time</span> <span class="pre">/</span> <span class="pre">5.</span></code></p></td>
</tr>
<tr class="row-even"><td><p>fuel_burned</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">initial_mass</span> <span class="pre">-</span> <span class="pre">mass_final</span></code> (for <code class="docutils literal notranslate"><span class="pre">FLOPS</span></code> mission only)</p></td>
</tr>
<tr class="row-odd"><td><p>fuel</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Mission.Objectives.FUEL</span></code></p></td>
</tr>
</tbody>
</table>
<p>As listed in the above, if <code class="docutils literal notranslate"><span class="pre">objective_type=&quot;mass&quot;</span></code>, the objective is the final value of <code class="docutils literal notranslate"><span class="pre">Dynamic.Mission.MASS</span></code> at the end of the mission.
If <code class="docutils literal notranslate"><span class="pre">objective_type=&quot;fuel&quot;</span></code>, the objective is the <code class="docutils literal notranslate"><span class="pre">Mission.Objectives.FUEL</span></code>.
There is a special objective type: <code class="docutils literal notranslate"><span class="pre">hybrid_objective</span></code>. When <code class="docutils literal notranslate"><span class="pre">objective_type=&quot;hybrid_objective&quot;</span></code>, the objective is a mix of minimizing fuel burn and minimizing the mission duration:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>      <span class="n">obj</span> <span class="o">=</span> <span class="o">-</span><span class="n">final_mass</span> <span class="o">/</span> <span class="p">{</span><span class="n">takeoff_mass</span><span class="p">}</span> <span class="o">+</span> <span class="n">final_time</span> <span class="o">/</span> <span class="mf">5.</span>
</pre></div>
</div>
<p>This is because if we just minimized fuel burn then the optimizer would probably fly the plane slowly to save fuel, but we actually care about some mix of minimizing fuel burn while providing a reasonable travel time for the passengers. This leads to the <code class="docutils literal notranslate"><span class="pre">hybrid_objective</span></code> which seeks to minimize a combination of those two objectives. <code class="docutils literal notranslate"><span class="pre">final_time</span></code> is the duration of the full mission and is usually in the range of hours. So, the denominator <code class="docutils literal notranslate"><span class="pre">5.</span></code> means <code class="docutils literal notranslate"><span class="pre">5</span> <span class="pre">hours</span></code>. That’s just a value to scale the final_time variable. Since it’s a composite objective we didn’t want to have OpenMDAO do the scaling because the two variables in the objective are of a different order of magnitude. We will show an example of this objective type in level 2 discussion.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">objective_type=None</span></code> for a <code class="docutils literal notranslate"><span class="pre">2DOF</span></code> mission, Aviary will choose the objective based on <code class="docutils literal notranslate"><span class="pre">mission_method</span></code> and <code class="docutils literal notranslate"><span class="pre">problem_type</span></code>. We have discussed this case earlier in this page.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">objective_type=None</span></code> for a <code class="docutils literal notranslate"><span class="pre">FLOPS</span></code> mission method, Aviary adds a <code class="docutils literal notranslate"><span class="pre">fuel_burned</span></code> objective. In fact, this objective is available for <code class="docutils literal notranslate"><span class="pre">FLOPS</span></code> mission only. That number you get is for the actual fuel burned in lbm. You may get something like <code class="docutils literal notranslate"><span class="pre">fuel_burned</span></code> with the scaled value <code class="docutils literal notranslate"><span class="pre">[3.91228276]</span></code>, reference value <code class="docutils literal notranslate"><span class="pre">1e+04</span></code>. It translates to the dimensional physical quantity of <code class="docutils literal notranslate"><span class="pre">39,122.8276</span></code> lbm. To see this in action, check the resulting <code class="docutils literal notranslate"><span class="pre">reports/opt_report.html</span></code> file to see the optimal results.</p>
<p><strong>Note:</strong>  Aviary variable <code class="docutils literal notranslate"><span class="pre">Mission.Objectives.FUEL</span></code> when using the GASP-based mission is actually a hybrid objective defined as</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>      <span class="n">reg_objective</span> <span class="o">=</span> <span class="n">overall_fuel</span><span class="o">/</span><span class="mi">10000</span> <span class="o">+</span> <span class="n">ascent_duration</span><span class="o">/</span><span class="mf">30.</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">overall_fuel</span></code> has the unit of <code class="docutils literal notranslate"><span class="pre">lbm</span></code> and <code class="docutils literal notranslate"><span class="pre">ascent_duration</span></code> has the unit of seconds. In our case, <code class="docutils literal notranslate"><span class="pre">settings:equations_of_motion</span> <span class="pre">=</span> <span class="pre">2DOF</span></code>, the final value of objective is <code class="docutils literal notranslate"><span class="pre">[5.5910123]</span></code>, with <code class="docutils literal notranslate"><span class="pre">ref:</span> <span class="pre">1.0</span></code> and <code class="docutils literal notranslate"><span class="pre">units:</span> <span class="pre">blank</span></code>. The units should be interpreted as <code class="docutils literal notranslate"><span class="pre">unitless</span></code>.</p>
<p>Here, <code class="docutils literal notranslate"><span class="pre">ref</span></code> is the reference value. For different objectives, the range may vary significantly different. We want to normalize the value. Ideally, users should choose <code class="docutils literal notranslate"><span class="pre">ref</span></code> such that the objective is in the range of <code class="docutils literal notranslate"><span class="pre">(0,1)</span></code>. This is required by optimizer.</p>
<p><strong>Note:</strong>  Unfortunately, not all <code class="docutils literal notranslate"><span class="pre">objective_type</span></code> and <code class="docutils literal notranslate"><span class="pre">mission_method</span></code> combinations work.</p>
<p>Next is a line to call</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prob</span><span class="o">.</span><span class="n">setup</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/usr/share/miniconda/envs/test/lib/python3.12/site-packages/dymos/phase/phase.py:1973: UserWarning: Phase time options have no effect because fix_initial=True or input_initial=True for phase &#39;traj.phases.groundroll&#39;: initial_ref
  warnings.warn(f&#39;Phase time options have no effect because fix_initial=True &#39;
/usr/share/miniconda/envs/test/lib/python3.12/site-packages/dymos/phase/phase.py:1973: UserWarning: Phase time options have no effect because fix_initial=True or input_initial=True for phase &#39;traj.phases.rotation&#39;: initial_ref
  warnings.warn(f&#39;Phase time options have no effect because fix_initial=True &#39;
/usr/share/miniconda/envs/test/lib/python3.12/site-packages/dymos/phase/phase.py:1973: UserWarning: Phase time options have no effect because fix_initial=True or input_initial=True for phase &#39;traj.phases.accel&#39;: initial_ref
  warnings.warn(f&#39;Phase time options have no effect because fix_initial=True &#39;
/usr/share/miniconda/envs/test/lib/python3.12/site-packages/dymos/phase/phase.py:1973: UserWarning: Phase time options have no effect because fix_initial=True or input_initial=True for phase &#39;traj.phases.climb1&#39;: initial_ref
  warnings.warn(f&#39;Phase time options have no effect because fix_initial=True &#39;
/usr/share/miniconda/envs/test/lib/python3.12/site-packages/dymos/phase/phase.py:1973: UserWarning: Phase time options have no effect because fix_initial=True or input_initial=True for phase &#39;traj.phases.climb2&#39;: initial_ref
  warnings.warn(f&#39;Phase time options have no effect because fix_initial=True &#39;
/usr/share/miniconda/envs/test/lib/python3.12/site-packages/dymos/phase/phase.py:1973: UserWarning: Phase time options have no effect because fix_initial=True or input_initial=True for phase &#39;traj.phases.desc1&#39;: initial_ref
  warnings.warn(f&#39;Phase time options have no effect because fix_initial=True &#39;
/usr/share/miniconda/envs/test/lib/python3.12/site-packages/dymos/phase/phase.py:1973: UserWarning: Phase time options have no effect because fix_initial=True or input_initial=True for phase &#39;traj.phases.desc2&#39;: initial_ref
  warnings.warn(f&#39;Phase time options have no effect because fix_initial=True &#39;
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The following variables have been overridden:
  &#39;aircraft:engine:scale_factor
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- Constraint Report [traj] ---
    --- groundroll ---
        None
    --- rotation ---
        [final]   0.0000e+00 == normal_force [lbf]
    --- ascent ---
        [final]   5.0000e+02 == altitude [ft]
        [path]    0.0000e+00 &lt;= load_factor &lt;= 1.1000e+00  [unitless]
        [path]    0.0000e+00 &lt;= fuselage_pitch &lt;= 1.5000e+01  [deg]
    --- accel ---
        [final]   2.5000e+02 == EAS [kn]
    --- climb1 ---
        [final]   1.0000e+04 == altitude [ft]
    --- climb2 ---
        [final]   3.7500e+04 == altitude [ft]
        [final]   1.0000e-01 &lt;= altitude_rate  [ft/min]
        [final]   8.0000e-01 == mach [unitless]
    --- cruise ---
        None
    --- desc1 ---
        [final]   1.0000e+04 == altitude [ft]
    --- desc2 ---
        [final]   1.0000e+03 == altitude [ft]
</pre></div>
</div>
</div>
</div>
<p>This is a lightly wrapped OpenMDAO <code class="docutils literal notranslate"><span class="pre">setup()</span></code> method for the problem. It allows us to do <code class="docutils literal notranslate"><span class="pre">pre-</span></code> and <code class="docutils literal notranslate"><span class="pre">post-setup</span></code> changes, like adding calls to <code class="docutils literal notranslate"><span class="pre">set_input_defaults</span></code> and do some simple <code class="docutils literal notranslate"><span class="pre">set_vals</span></code> if needed.</p>
<p>If we look at the signature of <code class="docutils literal notranslate"><span class="pre">setup()</span></code> in OpenMDAO’s <a class="reference external" href="https://openmdao.org/newdocs/versions/latest/_srcdocs/packages/core/problem.html">Problem</a> class, we find that the available kwargs are: <code class="docutils literal notranslate"><span class="pre">check</span></code>, <code class="docutils literal notranslate"><span class="pre">logger</span></code>, <code class="docutils literal notranslate"><span class="pre">mode</span></code>, <code class="docutils literal notranslate"><span class="pre">force_alloc_complex</span></code>, <code class="docutils literal notranslate"><span class="pre">distributed_vector_class</span></code>, <code class="docutils literal notranslate"><span class="pre">local_vector_class</span></code>, and <code class="docutils literal notranslate"><span class="pre">derivatives</span></code>. The ones that Aviary uses are <code class="docutils literal notranslate"><span class="pre">check</span></code> and <code class="docutils literal notranslate"><span class="pre">force_alloc_complex</span></code>. Argument <code class="docutils literal notranslate"><span class="pre">check</span></code> is a flag to determine default checks are performed. <a class="reference external" href="https://openmdao.org/newdocs/versions/latest/theory_manual/setup_stack.html">Default checks</a> are: ‘auto_ivc_warnings’, comp_has_no_outputs’, ‘dup_inputs’, ‘missing_recorders’, ‘out_of_order’, ‘solvers’, ‘system’, ‘unserializable_options’.</p>
<p>If <a class="reference external" href="https://openmdao.org/newdocs/versions/latest/advanced_user_guide/complex_step.html">force_alloc_complex</a> is true, sufficient memory will be allocated to allow nonlinear vectors to store complex values while operating under complex step. For our example, we don’t use any of them.</p>
<p>For optimization problems, initial guesses are important.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prob</span><span class="o">.</span><span class="n">set_initial_guesses</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>For <code class="docutils literal notranslate"><span class="pre">simple</span></code> and <code class="docutils literal notranslate"><span class="pre">2DOF</span></code> missions, this method performs several calls to <code class="docutils literal notranslate"><span class="pre">set_val</span></code> on the trajectory for states and controls to seed the problem with reasonable initial guesses using <code class="docutils literal notranslate"><span class="pre">initial_guesses</span></code> within corresponding phases (e.g. <code class="docutils literal notranslate"><span class="pre">default_flops_phases.py</span></code> and <code class="docutils literal notranslate"><span class="pre">default_gasp_phases.py</span></code>). For <code class="docutils literal notranslate"><span class="pre">solved</span></code> missions, it performs similar tasks but for hard-coded state parameters. This is reasonable because a <code class="docutils literal notranslate"><span class="pre">solved</span></code> mission is actually a level 3 Aviary approach. We will cover it in <a class="reference internal" href="onboarding_level3.html"><span class="std std-doc">level 3 onboarding doc</span></a> in the next page. Note that initial guesses for all phases are especially important for collocation methods.</p>
<p>The last line is to run the problem we just set up:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prob</span><span class="o">.</span><span class="n">run_aviary_problem</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/usr/share/miniconda/envs/test/lib/python3.12/site-packages/openmdao/recorders/sqlite_recorder.py:226: UserWarning:The existing case recorder file, aviary_history.db, is being overwritten.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Model viewer data has already been recorded for Driver.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Model viewer data has already been recorded for Driver.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Full total jacobian for problem &#39;problem2&#39; was computed 3 times, taking 2.186363703999973 seconds.
Total jacobian shape: (238, 209) 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Jacobian shape: (238, 209)  (6.61% nonzero)
FWD solves: 35   REV solves: 0
Total colors vs. total size: 35 vs 209  (83.25% improvement)

Sparsity computed using tolerance: 1e-25
Time to compute sparsity:   2.1864 sec
Time to compute coloring:   0.1764 sec
Memory to compute coloring:   0.0000 MB
Coloring created on: 2024-04-04 21:37:33
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/usr/share/miniconda/envs/test/lib/python3.12/site-packages/openmdao/core/total_jac.py:1627: DerivativesWarning:Constraints or objectives [(&#39;traj.phases.climb2-&gt;final_boundary_constraint-&gt;mach&#39;, inds=[(11, 0)])] cannot be impacted by the design variables of the problem.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>This is Ipopt version 3.14.14, running with linear solver MUMPS 5.6.2.

Number of nonzeros in equality constraint Jacobian...:     2404
Number of nonzeros in inequality constraint Jacobian.:      410
Number of nonzeros in Lagrangian Hessian.............:        0

Total number of variables............................:      209
                     variables with only lower bounds:        0
                variables with lower and upper bounds:      209
                     variables with only upper bounds:        0
Total number of equality constraints.................:      204
Total number of inequality constraints...............:       33
        inequality constraints with only lower bounds:        1
   inequality constraints with lower and upper bounds:       32
        inequality constraints with only upper bounds:        0

iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
   0  5.0977333e+00 1.74e+03 1.50e+01  -5.0 0.00e+00    -  0.00e+00 0.00e+00   0
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Number of Iterations....: 1

                                   (scaled)                 (unscaled)
Objective...............:   4.8883503059608309e+00    4.8883503059608309e+00
Dual infeasibility......:   1.4427886073849191e+01    1.4427886073849191e+01
Constraint violation....:   2.3994717416751503e+00    1.2096709903658193e+03
Variable bound violation:   0.0000000000000000e+00    0.0000000000000000e+00
Complementarity.........:   1.0000016687732632e+05    1.0000016687732632e+05
Overall NLP error.......:   1.0000016687732632e+05    1.0000016687732632e+05


Number of objective function evaluations             = 2
Number of objective gradient evaluations             = 2
Number of equality constraint evaluations            = 2
Number of inequality constraint evaluations          = 2
Number of equality constraint Jacobian evaluations   = 2
Number of inequality constraint Jacobian evaluations = 2
Number of Lagrangian Hessian evaluations             = 0
Total seconds in IPOPT                               = 2.664

EXIT: Maximum Number of Iterations Exceeded.
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<p>This is a simple wrapper of Dymos’ <a class="reference external" href="https://openmdao.github.io/dymos/api/run_problem_function.html">run_problem()</a> function. It allows the users to provide <code class="docutils literal notranslate"><span class="pre">record_filename</span></code>, <code class="docutils literal notranslate"><span class="pre">restart_filename</span></code>, <code class="docutils literal notranslate"><span class="pre">suppress_solver_print</span></code>, and <code class="docutils literal notranslate"><span class="pre">run_driver</span></code>. In our case, <code class="docutils literal notranslate"><span class="pre">record_filename</span></code> is changed to <code class="docutils literal notranslate"><span class="pre">aviary_history.db</span></code> and <code class="docutils literal notranslate"><span class="pre">restart_filename</span></code> is set to <code class="docutils literal notranslate"><span class="pre">None</span></code>. The rest of the arguments take default values. If a restart file name is provided, aviary (or dymos) will load the states, controls, and parameters as given in the provided case as the initial guess for the next run. We have discussed the <code class="docutils literal notranslate"><span class="pre">.db</span></code> file in <a class="reference internal" href="onboarding_level1.html"><span class="std std-doc">level 1 onboarding doc</span></a> and will discuss how to use it to generate useful output in <a class="reference internal" href="onboarding_level3.html"><span class="std std-doc">level 3 onboarding doc</span></a>.</p>
<p>Finally, we can add a few print statements for the variables that we are interested:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mission.Objectives.FUEL&quot;</span><span class="p">,</span>
      <span class="n">prob</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="n">Mission</span><span class="o">.</span><span class="n">Objectives</span><span class="o">.</span><span class="n">FUEL</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;unitless&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mission.Design.FUEL_MASS&quot;</span><span class="p">,</span>
      <span class="n">prob</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="n">Mission</span><span class="o">.</span><span class="n">Design</span><span class="o">.</span><span class="n">FUEL_MASS</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;lbm&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mission.Design.FUEL_MASS_REQUIRED&quot;</span><span class="p">,</span>
      <span class="n">prob</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="n">Mission</span><span class="o">.</span><span class="n">Design</span><span class="o">.</span><span class="n">FUEL_MASS_REQUIRED</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;lbm&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mission.Summary.TOTAL_FUEL_MASS&quot;</span><span class="p">,</span>
      <span class="n">prob</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="n">Mission</span><span class="o">.</span><span class="n">Summary</span><span class="o">.</span><span class="n">TOTAL_FUEL_MASS</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;lbm&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mission.Summary.GROSS_MASS (takeoff_mass)&quot;</span><span class="p">,</span>
      <span class="n">prob</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="n">Mission</span><span class="o">.</span><span class="n">Summary</span><span class="o">.</span><span class="n">GROSS_MASS</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;lbm&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mission.Landing.TOUCHDOWN_MASS (final_mass)&quot;</span><span class="p">,</span>
      <span class="n">prob</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="n">Mission</span><span class="o">.</span><span class="n">Landing</span><span class="o">.</span><span class="n">TOUCHDOWN_MASS</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;lbm&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Groundroll Final Mass (lbm)&quot;</span><span class="p">,</span>
      <span class="n">prob</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">&#39;traj.phases.groundroll.states:mass&#39;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;lbm&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Rotation Final Mass (lbm)&quot;</span><span class="p">,</span>
      <span class="n">prob</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">&#39;traj.rotation.states:mass&#39;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;lbm&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Ascent Final Mass (lbm)&quot;</span><span class="p">,</span>
      <span class="n">prob</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">&#39;traj.ascent.states:mass&#39;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;lbm&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Accel Final Mass (lbm)&quot;</span><span class="p">,</span>
      <span class="n">prob</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">&#39;traj.accel.states:mass&#39;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;lbm&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Climb1 Final Mass (lbm)&quot;</span><span class="p">,</span>
      <span class="n">prob</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">&#39;traj.climb1.states:mass&#39;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;lbm&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Climb2 Final Mass (lbm)&quot;</span><span class="p">,</span>
      <span class="n">prob</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">&#39;traj.climb2.states:mass&#39;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;lbm&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Cruise Final Mass (lbm)&quot;</span><span class="p">,</span>
      <span class="n">prob</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">&#39;traj.phases.cruise.rhs.calc_weight.mass&#39;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;lbm&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Desc1 Final Mass (lbm)&quot;</span><span class="p">,</span>
      <span class="n">prob</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">&#39;traj.desc1.states:mass&#39;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;lbm&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Desc2 Final Mass (lbm)&quot;</span><span class="p">,</span>
      <span class="n">prob</span><span class="o">.</span><span class="n">get_val</span><span class="p">(</span><span class="s1">&#39;traj.desc2.states:mass&#39;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;lbm&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;done&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mission.Objectives.FUEL [4.88835031]
Mission.Design.FUEL_MASS [43181.36501344]
Mission.Design.FUEL_MASS_REQUIRED [43181.36501344]
Mission.Summary.TOTAL_FUEL_MASS [42542.59814326]
Mission.Summary.GROSS_MASS (takeoff_mass) [174899.26562475]
Mission.Landing.TOUCHDOWN_MASS (final_mass) [136069.54266213]

Groundroll Final Mass (lbm) [173574.33847798]
Rotation Final Mass (lbm) [173570.95158347]
Ascent Final Mass (lbm) [173565.18012008]
Accel Final Mass (lbm) [173516.56644427]
Climb1 Final Mass (lbm) [173334.90412281]
Climb2 Final Mass (lbm) [171390.53441973]
Cruise Final Mass (lbm) 136482.67102076387
Desc1 Final Mass (lbm) [136111.55506212]
Desc2 Final Mass (lbm) [136069.54266213]
done
</pre></div>
</div>
</div>
</div>
<p>We will cover user customized outputs in <a class="reference internal" href="onboarding_level3.html"><span class="std std-doc">level 3</span></a>.</p>
</section>
<section id="level-2-another-example">
<h2>Level 2: Another example<a class="headerlink" href="#level-2-another-example" title="Link to this heading">#</a></h2>
<p>We now use a similar aircraft, a large single aisle commercial transport aircraft, but with a different mass estimation and mission method. Let us run Aviary using this input deck in level 1 first.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>aviary<span class="w"> </span>run_mission<span class="w"> </span>models/test_aircraft/aircraft_for_bench_FwFm.csv<span class="w"> </span>--max_iter<span class="w"> </span><span class="m">0</span><span class="w"> </span>--optimizer<span class="w"> </span>IPOPT
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/usr/share/miniconda/envs/test/lib/python3.12/site-packages/pyoptsparse/pyOpt_MPI.py:68: UserWarning: mpi4py could not be imported. mpi4py is required to use the parallel gradient analysis and parallel objective analysis for non-gradient based optimizers. Continuing using a dummy MPI module from pyOptSparse.
  warnings.warn(warn)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Loaded default phase_info for height_energy equations of motion
/home/runner/work/Aviary/Aviary/aviary/subsystems/propulsion/engine_model.py:132: UserWarning: The value of aircraft:engine:wing_locations passed to EngineModel &lt;engine_deck&gt; is type &lt;class &#39;numpy.ndarray&#39;&gt;. Only the first entry in this iterable will be used.
  warnings.warn(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/usr/share/miniconda/envs/test/lib/python3.12/site-packages/dymos/trajectory/trajectory.py:1202: UnusedOptionWarning:Invalid option in linkage between climb:time and cruise:time in trajectory traj. The following options for add_linkage_constraint were specified but not valid when option &#39;connected&#39; is True: ref
/usr/share/miniconda/envs/test/lib/python3.12/site-packages/dymos/trajectory/trajectory.py:1202: UnusedOptionWarning:Invalid option in linkage between cruise:time and descent:time in trajectory traj. The following options for add_linkage_constraint were specified but not valid when option &#39;connected&#39; is True: ref
/usr/share/miniconda/envs/test/lib/python3.12/site-packages/dymos/trajectory/trajectory.py:1202: UnusedOptionWarning:Invalid option in linkage between climb:mass and cruise:mass in trajectory traj. The following options for add_linkage_constraint were specified but not valid when option &#39;connected&#39; is True: ref
/usr/share/miniconda/envs/test/lib/python3.12/site-packages/dymos/trajectory/trajectory.py:1202: UnusedOptionWarning:Invalid option in linkage between cruise:mass and descent:mass in trajectory traj. The following options for add_linkage_constraint were specified but not valid when option &#39;connected&#39; is True: ref
/usr/share/miniconda/envs/test/lib/python3.12/site-packages/dymos/trajectory/trajectory.py:1202: UnusedOptionWarning:Invalid option in linkage between climb:distance and cruise:distance in trajectory traj. The following options for add_linkage_constraint were specified but not valid when option &#39;connected&#39; is True: ref
/usr/share/miniconda/envs/test/lib/python3.12/site-packages/dymos/trajectory/trajectory.py:1202: UnusedOptionWarning:Invalid option in linkage between cruise:distance and descent:distance in trajectory traj. The following options for add_linkage_constraint were specified but not valid when option &#39;connected&#39; is True: ref
/usr/share/miniconda/envs/test/lib/python3.12/site-packages/dymos/phase/phase.py:1973: UserWarning: Phase time options have no effect because fix_initial=True or input_initial=True for phase &#39;traj.phases.climb&#39;: initial_ref
  warnings.warn(f&#39;Phase time options have no effect because fix_initial=True &#39;
/usr/share/miniconda/envs/test/lib/python3.12/site-packages/dymos/phase/phase.py:1973: UserWarning: Phase time options have no effect because fix_initial=True or input_initial=True for phase &#39;traj.phases.cruise&#39;: initial_ref
  warnings.warn(f&#39;Phase time options have no effect because fix_initial=True &#39;
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/usr/share/miniconda/envs/test/lib/python3.12/site-packages/dymos/phase/phase.py:1973: UserWarning: Phase time options have no effect because fix_initial=True or input_initial=True for phase &#39;traj.phases.descent&#39;: initial_ref
  warnings.warn(f&#39;Phase time options have no effect because fix_initial=True &#39;

The following variables have been overridden:
  &#39;aircraft:design:touchdown_mass
  &#39;aircraft:engine:mass
  &#39;aircraft:fins:mass
  &#39;aircraft:fuel:auxiliary_fuel_capacity
  &#39;aircraft:fuel:fuselage_fuel_capacity
  &#39;aircraft:fuel:total_capacity
  &#39;aircraft:fuselage:planform_area
  &#39;aircraft:fuselage:wetted_area
  &#39;aircraft:horizontal_tail:wetted_area
  &#39;aircraft:landing_gear:main_gear_oleo_length
  &#39;aircraft:landing_gear:nose_gear_oleo_length
  &#39;aircraft:vertical_tail:wetted_area
  &#39;aircraft:wing:aspect_ratio
  &#39;aircraft:wing:control_surface_area
  &#39;aircraft:wing:wetted_area
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- Constraint Report [traj] ---
    --- climb ---
        [path]    0.0000e+00 &lt;= throttle &lt;= 1.0000e+00  [unitless]
    --- cruise ---
        [initial] 0.0000e+00 &lt;= throttle &lt;= 1.0000e+00  [unitless]
        [final]   0.0000e+00 &lt;= throttle &lt;= 1.0000e+00  [unitless]
    --- descent ---
        [path]    0.0000e+00 &lt;= throttle &lt;= 1.0000e+00  [unitless]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/usr/share/miniconda/envs/test/lib/python3.12/site-packages/openmdao/recorders/sqlite_recorder.py:226: UserWarning:The existing case recorder file, dymos_solution.db, is being overwritten.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Model viewer data has already been recorded for Driver.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Model viewer data has already been recorded for Driver.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Full total jacobian for problem &#39;aircraft_for_bench_FwFm&#39; was computed 3 times, taking 0.6454077029999326 seconds.
Total jacobian shape: (135, 94) 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Jacobian shape: (135, 94)  (8.41% nonzero)
FWD solves: 13   REV solves: 0
Total colors vs. total size: 13 vs 94  (86.17% improvement)

Sparsity computed using tolerance: 1e-25
Time to compute sparsity:   0.6454 sec
Time to compute coloring:   0.0518 sec
Memory to compute coloring:   0.0000 MB
Coloring created on: 2024-04-04 21:37:51
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>This is Ipopt version 3.14.14, running with linear solver MUMPS 5.6.2.

Number of nonzeros in equality constraint Jacobian...:      689
Number of nonzeros in inequality constraint Jacobian.:      377
Number of nonzeros in Lagrangian Hessian.............:        0
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total number of variables............................:       94
                     variables with only lower bounds:        0
                variables with lower and upper bounds:       94
                     variables with only upper bounds:        0
Total number of equality constraints.................:       92
Total number of inequality constraints...............:       42
        inequality constraints with only lower bounds:        0
   inequality constraints with lower and upper bounds:       42
        inequality constraints with only upper bounds:        0

iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
   0  0.0000000e+00 1.90e+01 1.79e-02  -5.0 0.00e+00    -  0.00e+00 0.00e+00   0

Number of Iterations....: 0

                                   (scaled)                 (unscaled)
Objective...............:   0.0000000000000000e+00    0.0000000000000000e+00
Dual infeasibility......:   1.7857187127472085e-02    1.7857187127472085e-02
Constraint violation....:   1.9006004373650107e+01    1.9006004373650107e+01
Variable bound violation:   0.0000000000000000e+00    0.0000000000000000e+00
Complementarity.........:   1.0000000000000000e+17    1.0000000000000000e+17
Overall NLP error.......:   1.0000000000000000e+17    1.0000000000000000e+17


Number of objective function evaluations             = 1
Number of objective gradient evaluations             = 1
Number of equality constraint evaluations            = 1
Number of inequality constraint evaluations          = 1
Number of equality constraint Jacobian evaluations   = 1
Number of inequality constraint Jacobian evaluations = 1
Number of Lagrangian Hessian evaluations             = 0
Total seconds in IPOPT                               = 0.726

EXIT: Maximum Number of Iterations Exceeded.
</pre></div>
</div>
</div>
</div>
<p>Once again, to convert it to a level 2 model, we need to set all the arguments in level 1 manually.</p>
<p>By running a model in level 2 directly, we have the flexibility to modify the input parameters (e.g. <code class="docutils literal notranslate"><span class="pre">phase_info</span></code>). Let us continue to make modifications and obtain a different run script shown below:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">phase_info</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;pre_mission&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;include_takeoff&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s1">&#39;optimize_mass&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s1">&#39;cruise&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;subsystem_options&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;core_aerodynamics&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;method&#39;</span><span class="p">:</span> <span class="s1">&#39;computed&#39;</span><span class="p">}</span>
        <span class="p">},</span>
        <span class="s1">&#39;user_options&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;optimize_mach&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
            <span class="s1">&#39;optimize_altitude&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
            <span class="s1">&#39;polynomial_control_order&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s1">&#39;num_segments&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
            <span class="s1">&#39;order&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
            <span class="s1">&#39;solve_for_distance&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
            <span class="s1">&#39;initial_mach&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.72</span><span class="p">,</span> <span class="s1">&#39;unitless&#39;</span><span class="p">),</span>
            <span class="s1">&#39;final_mach&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.72</span><span class="p">,</span> <span class="s1">&#39;unitless&#39;</span><span class="p">),</span>
            <span class="s1">&#39;mach_bounds&#39;</span><span class="p">:</span> <span class="p">((</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.74</span><span class="p">),</span> <span class="s1">&#39;unitless&#39;</span><span class="p">),</span>
            <span class="s1">&#39;initial_altitude&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">35000.0</span><span class="p">,</span> <span class="s1">&#39;ft&#39;</span><span class="p">),</span>
            <span class="s1">&#39;final_altitude&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">35000.0</span><span class="p">,</span> <span class="s1">&#39;ft&#39;</span><span class="p">),</span>
            <span class="s1">&#39;altitude_bounds&#39;</span><span class="p">:</span> <span class="p">((</span><span class="mf">23000.0</span><span class="p">,</span> <span class="mf">38000.0</span><span class="p">),</span> <span class="s1">&#39;ft&#39;</span><span class="p">),</span>
            <span class="s1">&#39;throttle_enforcement&#39;</span><span class="p">:</span> <span class="s1">&#39;boundary_constraint&#39;</span><span class="p">,</span>
            <span class="s1">&#39;fix_initial&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
            <span class="s1">&#39;constrain_final&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
            <span class="s1">&#39;fix_duration&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
            <span class="s1">&#39;initial_bounds&#39;</span><span class="p">:</span> <span class="p">((</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span> <span class="s1">&#39;min&#39;</span><span class="p">),</span>
            <span class="s1">&#39;duration_bounds&#39;</span><span class="p">:</span> <span class="p">((</span><span class="mf">10.</span><span class="p">,</span> <span class="mf">30.</span><span class="p">),</span> <span class="s1">&#39;min&#39;</span><span class="p">),</span>
        <span class="p">},</span>
        <span class="s1">&#39;initial_guesses&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span> <span class="s1">&#39;min&#39;</span><span class="p">)},</span>
    <span class="p">},</span>
    <span class="s1">&#39;post_mission&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;include_landing&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">}</span>

<span class="c1"># inputs that run_aviary() requires</span>
<span class="n">aircraft_filename</span> <span class="o">=</span> <span class="s2">&quot;models/test_aircraft/aircraft_for_bench_FwFm.csv&quot;</span>
<span class="n">mission_method</span> <span class="o">=</span> <span class="s2">&quot;height_energy_energy&quot;</span>
<span class="n">mass_method</span> <span class="o">=</span> <span class="s2">&quot;FLOPS&quot;</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="s2">&quot;SLSQP&quot;</span>
<span class="n">analysis_scheme</span> <span class="o">=</span> <span class="n">av</span><span class="o">.</span><span class="n">AnalysisScheme</span><span class="o">.</span><span class="n">COLLOCATION</span>
<span class="n">objective_type</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">record_filename</span> <span class="o">=</span> <span class="s1">&#39;history.db&#39;</span>
<span class="n">restart_filename</span> <span class="o">=</span> <span class="kc">None</span>

<span class="c1"># Build problem</span>
<span class="n">prob</span> <span class="o">=</span> <span class="n">av</span><span class="o">.</span><span class="n">AviaryProblem</span><span class="p">(</span><span class="n">analysis_scheme</span><span class="p">)</span>

<span class="c1"># Load aircraft and options data from user</span>
<span class="c1"># Allow for user overrides here</span>
<span class="n">prob</span><span class="o">.</span><span class="n">load_inputs</span><span class="p">(</span><span class="n">aircraft_filename</span><span class="p">,</span> <span class="n">phase_info</span><span class="p">)</span>

<span class="c1"># Preprocess inputs</span>
<span class="n">prob</span><span class="o">.</span><span class="n">check_and_preprocess_inputs</span><span class="p">()</span>

<span class="n">prob</span><span class="o">.</span><span class="n">add_pre_mission_systems</span><span class="p">()</span>

<span class="n">prob</span><span class="o">.</span><span class="n">add_phases</span><span class="p">()</span>

<span class="n">prob</span><span class="o">.</span><span class="n">add_post_mission_systems</span><span class="p">()</span>

<span class="c1"># Link phases and variables</span>
<span class="n">prob</span><span class="o">.</span><span class="n">link_phases</span><span class="p">()</span>

<span class="n">prob</span><span class="o">.</span><span class="n">add_driver</span><span class="p">(</span><span class="n">optimizer</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">prob</span><span class="o">.</span><span class="n">add_design_variables</span><span class="p">()</span>

<span class="c1"># Load optimization problem formulation</span>
<span class="c1"># Detail which variables the optimizer can control</span>
<span class="n">prob</span><span class="o">.</span><span class="n">add_objective</span><span class="p">(</span><span class="n">objective_type</span><span class="o">=</span><span class="n">objective_type</span><span class="p">)</span>

<span class="n">prob</span><span class="o">.</span><span class="n">setup</span><span class="p">()</span>

<span class="n">prob</span><span class="o">.</span><span class="n">set_initial_guesses</span><span class="p">()</span>

<span class="n">prob</span><span class="o">.</span><span class="n">run_aviary_problem</span><span class="p">(</span><span class="n">record_filename</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;done&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/runner/work/Aviary/Aviary/aviary/subsystems/propulsion/engine_model.py:132: UserWarning: The value of aircraft:engine:wing_locations passed to EngineModel &lt;engine_deck&gt; is type &lt;class &#39;numpy.ndarray&#39;&gt;. Only the first entry in this iterable will be used.
  warnings.warn(
/usr/share/miniconda/envs/test/lib/python3.12/site-packages/dymos/phase/phase.py:1973: UserWarning: Phase time options have no effect because fix_initial=True or input_initial=True for phase &#39;traj.phases.cruise&#39;: initial_ref
  warnings.warn(f&#39;Phase time options have no effect because fix_initial=True &#39;
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The following variables have been overridden:
  &#39;aircraft:design:touchdown_mass
  &#39;aircraft:engine:mass
  &#39;aircraft:fins:mass
  &#39;aircraft:fuel:auxiliary_fuel_capacity
  &#39;aircraft:fuel:fuselage_fuel_capacity
  &#39;aircraft:fuel:total_capacity
  &#39;aircraft:fuselage:planform_area
  &#39;aircraft:fuselage:wetted_area
  &#39;aircraft:horizontal_tail:wetted_area
  &#39;aircraft:landing_gear:main_gear_oleo_length
  &#39;aircraft:landing_gear:nose_gear_oleo_length
  &#39;aircraft:vertical_tail:wetted_area
  &#39;aircraft:wing:aspect_ratio
  &#39;aircraft:wing:control_surface_area
  &#39;aircraft:wing:wetted_area

--- Constraint Report [traj] ---
    --- cruise ---
        [initial] 0.0000e+00 &lt;= throttle &lt;= 1.0000e+00  [unitless]
        [final]   0.0000e+00 &lt;= throttle &lt;= 1.0000e+00  [unitless]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Model viewer data has already been recorded for Driver.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Full total jacobian for problem &#39;problem3&#39; was computed 3 times, taking 0.04917578599997796 seconds.
Total jacobian shape: (16, 13) 


Jacobian shape: (16, 13)  (33.65% nonzero)
FWD solves: 6   REV solves: 0
Total colors vs. total size: 6 vs 13  (53.85% improvement)

Sparsity computed using tolerance: 1e-25
Time to compute sparsity:   0.0492 sec
Time to compute coloring:   0.0076 sec
Memory to compute coloring:   0.0000 MB
Coloring created on: 2024-04-04 21:37:56
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/usr/share/miniconda/envs/test/lib/python3.12/site-packages/openmdao/core/driver.py:466: DriverWarning:The following design variable initial conditions are out of their specified bounds:
  traj.cruise.t_duration
    val: [1800.]
    lower: 600.0
    upper: 1799.9999999999998
Set the initial value of the design variable to a valid value or set the driver option[&#39;invalid_desvar_behavior&#39;] to &#39;ignore&#39;.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Iteration limit reached    (Exit mode 9)
            Current function value: 0.0
            Iterations: 1
            Function evaluations: 1
            Gradient evaluations: 1
Optimization FAILED.
Iteration limit reached
-----------------------------------
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/usr/share/miniconda/envs/test/lib/python3.12/site-packages/openmdao/core/total_jac.py:1627: DerivativesWarning:Constraints or objectives [(&#39;traj.phases.cruise-&gt;initial_boundary_constraint-&gt;throttle&#39;, inds=[(0, 0)])] cannot be impacted by the design variables of the problem.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>done
</pre></div>
</div>
</div>
</div>
<p>As you see, there is a single phase <code class="docutils literal notranslate"><span class="pre">cruise</span></code>, no takeoff, no landing. Note that we must set <code class="docutils literal notranslate"><span class="pre">include_takeoff</span></code> to <code class="docutils literal notranslate"><span class="pre">False</span></code> because Aviary internally tries to connect takeoff to climb phase which we don’t provide. There should be a check to see if both takeoff and climb phase exist first. Aviary still has many things to be improved.</p>
<p>We will see more details for what users can do in <a class="reference internal" href="onboarding_level3.html"><span class="std std-doc">level 3</span></a>.</p>
<p>Level 2 is where you can integrate user-defined <a class="reference internal" href="../user_guide/subsystems.html"><span class="std std-doc">external subsystems</span></a>, which is one of the main features of the Aviary tool. <a class="reference internal" href="../user_guide/using_external_subsystems.html"><span class="std std-doc">Examples</span></a> of external subsystems are: acoustics, battery modeling, etc.
Assume that you already have an external subsystem that you want to incorporate it into your model. We show how to add external subsystems via <code class="docutils literal notranslate"><span class="pre">external_subsystems</span></code> key in <code class="docutils literal notranslate"><span class="pre">phase_info</span></code>.</p>
<p>We will cover external subsystems in details in <a class="reference internal" href="onboarding_ext_subsystem.html"><span class="std std-doc">Models with External Subsystems</span></a> page.</p>
</section>
<section id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Link to this heading">#</a></h2>
<p>As you see, level 2 is more flexible than level 1. In level 2, you can:</p>
<ul class="simple">
<li><p>add/remove pre-defined mission phases (via <code class="docutils literal notranslate"><span class="pre">phase_info</span></code>, see example above);</p></li>
<li><p>scale design variables (via reference value in <code class="docutils literal notranslate"><span class="pre">phase_info</span></code>)</p></li>
<li><p>import additional files (e.g. <code class="docutils literal notranslate"><span class="pre">aero_data_file</span></code>);</p></li>
<li><p>set pre-defined objective (e.g. <code class="docutils literal notranslate"><span class="pre">hybrid_objective</span></code>);</p></li>
<li><p>add external subsystems (via <code class="docutils literal notranslate"><span class="pre">phase_info</span></code>);</p></li>
<li><p>set <code class="docutils literal notranslate"><span class="pre">use_coloring</span></code> (see example above).</p></li>
</ul>
<p>Most Aviary users should be well-served by Level 2; we have purposefully constructed it to be capable of most all use cases, even those on the forefront of research in aircraft design.</p>
<p>That being said, there are some cases where Level 2 is not sufficient and you may need additional flexibility. We are ready to move on to <a class="reference internal" href="onboarding_level3.html"><span class="std std-doc">Level 3</span></a>.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./getting_started"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="onboarding_level1.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Level 1</p>
      </div>
    </a>
    <a class="right-next"
       href="onboarding_level3.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Level 3</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#build-level-2-for-the-same-aircraft-for-bench-gwgm-model">Build level 2 for the same <code class="docutils literal notranslate"><span class="pre">aircraft_for_bench_GwGm</span></code> Model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dissection-of-level-2-for-the-same-aircraft-for-bench-gwgm-model">Dissection of level 2 for the same <code class="docutils literal notranslate"><span class="pre">aircraft_for_bench_GwGm</span></code> model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#level-2-another-example">Level 2: Another example</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">Summary</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Aviary team at NASA
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>